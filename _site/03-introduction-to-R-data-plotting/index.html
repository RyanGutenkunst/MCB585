















<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2019-09-16 22:53:18 -0700">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/syntax.css" />

    



    <!-- Favicons for everyone -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../assets/favicons/mcb585/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/favicons/mcb585/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/favicons/mcb585/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/favicons/mcb585/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../assets/favicons/mcb585/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../assets/favicons/mcb585/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../assets/favicons/mcb585/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../assets/favicons/mcb585/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content=" - MCB 585: Multidisciplinary/Quantitative Approaches to Solving Biological Problems"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="../assets/favicons/mcb585/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="../assets/favicons/mcb585/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="../assets/favicons/mcb585/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="../assets/favicons/mcb585/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="../assets/favicons/mcb585/mstile-310x310.png" />


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
    <title>MCB 585: Multidisciplinary/Quantitative Approaches to Solving Biological Problems: Introduction to R -- Reading, Writing, and Plotting Data</title>
  </head>
  <body>

    



    <div class="container">
      






<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      
      <a href="https://georgesutphin.github.io/MCB585/" class="pull-left">
        <img class="navbar-logo" src="../assets/img/mcb585-logo.svg" alt="MCB585 logo" />
      </a>
      

      
      <a class="navbar-brand" href="../">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>

        
	
        <li><a href="../setup.html">Setup</a></li>

        
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../01-R-RStudio-setup/index.html">Getting started with R and RStudio</a></li>
            
            <li><a href="../02-introduction-to-R-basics/index.html">Introduction to R -- Best Practices, Data Types, and Data Structures</a></li>
            
            <li><a href="../03-introduction-to-R-data-plotting/index.html">Introduction to R -- Reading, Writing, and Plotting Data</a></li>
            
            <li><a href="../04-introduction-to-R-decisions-and-loops/index.html">Introduction to R -- Decisions and Loops</a></li>
            
	    <li role="separator" class="divider"></li>
            <li><a href="../aio.html">All in one page (Beta)</a></li>
          </ul>
        </li>
	

	
	<!--
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../reference.html">Reference</a></li>
            
            <li><a href="../about/">About</a></li>
            
            <li><a href="../discuss/">Discussion</a></li>
            
            <li><a href="../figures/">Figures</a></li>
            
            <li><a href="../guide/">Instructor Notes</a></li>
            
          </ul>
        </li>
	-->

	
        <li><a href="../LICENSE.html">About</a></li>
	<!--
	
	<li><a href="/edit//_episodes_rmd/03-introduction-to-R-data-plotting.Rmd">Improve this page <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></li>
	
	-->
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>

















<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../02-introduction-to-R-basics/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
    <h3 class="maintitle"><a href="../">MCB 585: Multidisciplinary/Quantitative Approaches to Solving Biological Problems</a></h3>
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../04-introduction-to-R-decisions-and-loops/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>

<article>
<div class="row">
  <div class="col-md-1">
  </div>
  <div class="col-md-10">
    <h1 class="maintitle">Introduction to R -- Reading, Writing, and Plotting Data</h1>
  </div>
  <div class="col-md-1">
  </div>
</div>


<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Class Date:</strong> 9/9/2019
      <br/>
      <strong>Teaching:</strong> 80 min
      <br/>
      <strong>Exercises:</strong> 25 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>How do I read data from a .csv or .txt file into R?</p>
</li>
	
	<li><p>How do I write data to a .csv or .txt file?</p>
</li>
	
	<li><p>How do I calculate simple statistics from my data?</p>
</li>
	
	<li><p>How can I plot my data?</p>
</li>
	
	<li><p>How do I save my plots to a PDF file?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Import data from a .csv or .txt file using the <code class="highlighter-rouge">read.table(...)</code>, <code class="highlighter-rouge">read.csv(...)</code>, and <code class="highlighter-rouge">read.delim(...)</code> functions.</p>
</li>
	
	<li><p>Use <code class="highlighter-rouge">mean</code>, <code class="highlighter-rouge">max</code>, <code class="highlighter-rouge">min</code>, and <code class="highlighter-rouge">sd</code> to calculate simple statistics.</p>
</li>
	
	<li><p>Write data to a new .csv or .txt file using the <code class="highlighter-rouge">write.table(...)</code> and <code class="highlighter-rouge">write.csv(...)</code> functions.</p>
</li>
	
	<li><p>Display simple graphs.</p>
</li>
	
	<li><p>Save plot(s) to a PDF file.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h3 id="reading-data-from-a-tabulated-file-csv-txt">Reading data from a tabulated file (.csv, .txt)</h3>

<p>In the majority of cases, your data will be stored in some type of external file. The most common way that scientists store data is in Excel spreadsheets. While there are R packages designed to access data from Excel spreadsheets (e.g., gdata, RODBC, XLConnect, xlsx, RExcel), these packages are often difficult and non-intuitive to use. When you start dealing with larger datasets, accessing data from Excel files in R also gets slow. users often find it easier to save their spreadsheets in one or more <a href="../reference.html#comma-separated-values-csv">comma-separated values</a> (CSV or .csv) or text (TXT or .txt) files and then use R’s built in functionality to read and manipulate the data. Both file types are more primitive forms of table/spreadsheet in which data is stored as text with distinct data elements separated by a <em>delimiting character</em> (a comma <code class="highlighter-rouge">,</code> for .csv files and usually a tab <code class="highlighter-rouge">\t</code> for .txt files).</p>

<p>Thankfully, Excel is capable of opening, editing, and saving both .csv and .txt files, so we can go back and forth between R and Excel when we find it convenient.</p>

<p>In this short lesson, we’ll learn how to read external data from a .csv or .txt file, and write data modified or generated in R to a new .csv or .txt file. We will also explore the <a href="../reference.html#argument">arguments</a> that allow you read and write the data correctly for your needs.</p>

<p> </p>
<h4 id="loading-external-data-into-a-data-frame">Loading external data into a data frame</h4>

<p>Let’s start by loading some sample data and take a look at the first few rows of the contents using the <code class="highlighter-rouge">head()</code>:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/sample.csv'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>Open up the same file using a basic text editor (e.g. <em>Notepad</em> in Windows; <em>TextEdit</em> in MacOS). You should see something like this:</p>

<blockquote class="callout">
  <p>“ID”,”Gender”,”Group”,”BloodPressure”,”Age”,”Aneurisms_q1”,”Aneurisms_q2”,”Aneurisms_q3”,”Aneurisms_q4” 
“Sub001”,”m”,”Control”,132,16,114,140,202,237
“Sub002”,”m”,”Treatment2”,139,17.2,148,209,248,248
“Sub003”,”m”,”Treatment2”,130,19.5,196,251,122,177
“Sub004”,”f”,”Treatment1”,105,15.7,199,140,233,220
“Sub005”,”m”,”Treatment1”,125,19.9,188,120,222,228
“Sub006”,”M”,”Treatment2”,112,14.3,260,266,320,294</p>
</blockquote>

<p> </p>

<p>A couple of things to notice:</p>
<ul>
  <li>The first line contains column headers.</li>
  <li>The <code class="highlighter-rouge">,</code> delimiters tell the <code class="highlighter-rouge">read.csv(...)</code> function where the breaks in the data are located; that is, which data to put in which column of the output data frame.</li>
  <li>Each new line is also a delimiter that tells <code class="highlighter-rouge">read.csv(...)</code> which data to put in which row in the output data frame</li>
  <li>In this case, all strings are contained within quotation marks <code class="highlighter-rouge">""</code>. This is an optional way to tell the program where character strings start and stop.</li>
</ul>

<p>On the topic of using quotation marks, open <code class="highlighter-rouge">sample-noquotes.csv</code> in your text editor to see the quote-free option:</p>

<blockquote class="callout">
  <p>ID,Gender,Group,BloodPressure,Age,Aneurisms_q1,Aneurisms_q2,Aneurisms_q3,Aneurisms_q4 
Sub001,m,Control,132,16,114,140,202,237
Sub002,m,Treatment2,139,17.2,148,209,248,248
Sub003,m,Treatment2,130,19.5,196,251,122,177
Sub004,f,Treatment1,105,15.7,199,140,233,220
Sub005,m,Treatment1,125,19.9,188,120,222,228
Sub006,M,Treatment2,112,14.3,260,266,320,294</p>
</blockquote>

<p> </p>

<p>And note that the default <code class="highlighter-rouge">read.csv(...)</code> treats this file identically:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dat2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/sample-noquotes.csv'</span><span class="p">)</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">dat2</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      ID Gender      Group BloodPressure  Age Aneurisms_q1 Aneurisms_q2
1 Sub001      m    Control           132 16.0          114          140
2 Sub002      m Treatment2           139 17.2          148          209
3 Sub003      m Treatment2           130 19.5          196          251
4 Sub004      f Treatment1           105 15.7          199          140
5 Sub005      m Treatment1           125 19.9          188          120
6 Sub006      M Treatment2           112 14.3          260          266
  Aneurisms_q3 Aneurisms_q4
1          202          237
2          248          248
3          122          177
4          233          220
5          222          228
6          320          294
</code></pre></div></div>

<p> </p>

<p>Whether to use quotes in your data files is up to you. The default behavior of <code class="highlighter-rouge">read.csv(...)</code> is smart enough to figure this out on it’s own. However, the <code class="highlighter-rouge">read.csv(...)</code> has an argument called <code class="highlighter-rouge">quote</code> that dictates how to interpret quotation marks.</p>

<blockquote class="challenge">
  <h2 id="mis-loading-quoted-data">Mis-loading quoted data</h2>

  <p>What if we force <code class="highlighter-rouge">read.csv("")</code> to ignore the quotes when they are present?
Before you run any code, think about what will happen to the data in quotes
if we tell R that there are no “quote” characters.</p>

  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dat3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/sample.csv'</span><span class="p">,</span><span class="w"> </span><span class="n">quote</span><span class="o">=</span><span class="s2">""</span><span class="p">)</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">dat3</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>

  <blockquote class="solution">
    <h2 id="solution">Solution</h2>

    <p>The quotes are now included as part of the character arguments. It also messed up the header 
formatting, appending an “X” to the beginning and surrounding text with “.”ss.</p>
  </blockquote>
</blockquote>

<p> </p>

<p>What happens if we don’t assign the output of <code class="highlighter-rouge">read.csv(...)</code> to a variable?</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/sample.csv'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>As with any other function call, if the output is not explicitly assigned, it will be dumped into the console window.</p>

<p> </p>
<h4 id="changing-delimiters">Changing Delimiters</h4>

<p>The default delimiter of the <code class="highlighter-rouge">read.csv()</code> function is a comma <code class="highlighter-rouge">,</code>, but you can
use essentially any set of characters as a delimiter. <code class="highlighter-rouge">read.csv(...)</code> is actually a special case of a broader function called <code class="highlighter-rouge">read.table(...)</code>, with the delimiter argument (which is <code class="highlighter-rouge">sep</code>, for “separator”) set to <code class="highlighter-rouge">c</code> by default. Check out the help file for these functions:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">?</span><span class="n">read.table</span><span class="w"> </span><span class="c1"># note that `?read.csv` brings up the same help document.</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>Under the <strong>Usage</strong> section there are multiple functions listed, including <code class="highlighter-rouge">read.table(...)</code> and <code class="highlighter-rouge">read.csv(...)</code>. In the parentheses for each function there is a list of arguments. Since <code class="highlighter-rouge">read.table(...)</code> is the parent function, all arguments are listed. Only arguments with different default values (as indicated by the <code class="highlighter-rouge">=</code>) are listed for <code class="highlighter-rouge">read.csv(...)</code>. A default value is the value that each argument assumes when you do not explicitly enter a value. For example, <code class="highlighter-rouge">read.table(...)</code> assumes that a data file has no header (<code class="highlighter-rouge">header = FALSE</code>) and no delimiting character (<code class="highlighter-rouge">sep = ""</code>) while <code class="highlighter-rouge">read.csv(...)</code> assumes that a data file does have a header (<code class="highlighter-rouge">header = TRUE</code>) and a comma as the delimiting character (<code class="highlighter-rouge">sep = ","</code>), unless you specify otherwise.</p>

<p>If your data is stored in a tab-delimited text file, you will need to use <code class="highlighter-rouge">read.table(...)</code> a different delimiting character, or another of the associated functions called <code class="highlighter-rouge">read.delim(...)</code> which has defaults to a tab-delimited file format. Note that to define a <em>tab</em> as a delimiting character, you have to use <code class="highlighter-rouge">\t</code>.</p>

<p>Let’s give it a try using a copy of the <code class="highlighter-rouge">sample.csv</code> data saved as a tab-delimited <code class="highlighter-rouge">sample.txt</code> file.</p>

<p><em>Note:</em> From the help file, <code class="highlighter-rouge">read.delim(...)</code> defaults to <code class="highlighter-rouge">header = TRUE</code> while we have to explicity definit it when using <code class="highlighter-rouge">read.table(...)</code>. We will talk about what this means in the next section.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># note that read</span><span class="w">
</span><span class="n">dat4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.delim</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/sample.txt'</span><span class="p">)</span><span class="w">
</span><span class="n">dat5</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.table</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/sample.txt'</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">dat4</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      ID Gender      Group BloodPressure  Age Aneurisms_q1 Aneurisms_q2
1 Sub001      m    Control           132 16.0          114          140
2 Sub002      m Treatment2           139 17.2          148          209
3 Sub003      m Treatment2           130 19.5          196          251
4 Sub004      f Treatment1           105 15.7          199          140
5 Sub005      m Treatment1           125 19.9          188          120
6 Sub006      M Treatment2           112 14.3          260          266
  Aneurisms_q3 Aneurisms_q4
1          202          237
2          248          248
3          122          177
4          233          220
5          222          228
6          320          294
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">dat5</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      ID Gender      Group BloodPressure  Age Aneurisms_q1 Aneurisms_q2
1 Sub001      m    Control           132 16.0          114          140
2 Sub002      m Treatment2           139 17.2          148          209
3 Sub003      m Treatment2           130 19.5          196          251
4 Sub004      f Treatment1           105 15.7          199          140
5 Sub005      m Treatment1           125 19.9          188          120
6 Sub006      M Treatment2           112 14.3          260          266
  Aneurisms_q3 Aneurisms_q4
1          202          237
2          248          248
3          122          177
4          233          220
5          222          228
6          320          294
</code></pre></div></div>

<p> </p>

<p>Now let’s take a closer look at a couple of useful arguments in <code class="highlighter-rouge">read.table(...)</code> family of functions.</p>

<p> </p>
<h4 id="the-header-argument">The <code class="highlighter-rouge">header</code> Argument</h4>

<p>The default for <code class="highlighter-rouge">read.csv(...)</code> and <code class="highlighter-rouge">read.delim(...)</code> is to set the <code class="highlighter-rouge">header</code> argument to <code class="highlighter-rouge">TRUE</code>. This means that the first row of values in the .csv or .txt is used to define the column names for the data frame. If your data set does not have a header, set the <code class="highlighter-rouge">header</code> argument to <code class="highlighter-rouge">FALSE</code>.</p>

<blockquote class="challenge">
  <h2 id="mis-loading-data-with-headers">Mis-loading data with headers</h2>

  <p>What happens if you forget to put <code class="highlighter-rouge">header = FALSE</code>? The default value is
<code class="highlighter-rouge">header = TRUE</code>, which you can check with <code class="highlighter-rouge">?read.csv</code> or <code class="highlighter-rouge">help(read.csv)</code>.
What do you expect will happen if you leave the default value?
Before you run any code, think about what will happen to the first few rows
of your data frame, and its overall size. Then run the following code and
see if your expectations agree:</p>

  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dat6</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/sample.csv'</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">dat6</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>

  <blockquote class="solution">
    <h2 id="solution-1">Solution</h2>

    <p>The <code class="highlighter-rouge">read.csv(...)</code> function sets the column names as the default values (<code class="highlighter-rouge">V1, V2, V3, ...</code>) and 
treats the first row of the <code class="highlighter-rouge">sample.csv</code> file as the first row of data. Clearly this is not the 
desired behavior for this data set, but it will be useful if you have a dataset without headers.
Note that the <code class="highlighter-rouge">V</code> is prepended just a number would not be a valid variable name.</p>
  </blockquote>
</blockquote>

<p> </p>
<h4 id="the-stringsasfactors-argument">The <code class="highlighter-rouge">stringsAsFactors</code> Argument</h4>

<p>This is perhaps the most important argument in <code class="highlighter-rouge">read.csv(...)</code>, particularly if you are working with categorical data. This is because the default behavior of R is to convert character <a href="../reference.html#string">string</a>s into factors, which may make it difficult to do such things as replace values.</p>

<p>For example, let’s look at the <code class="highlighter-rouge">car-speeds.csv</code> data set. We find out that the data collector was color blind, and accidentally recorded green cars as being blue. In order to correct the data set, let’s replace ‘Blue’ with ‘Green’ in the <code class="highlighter-rouge">$Color</code> column:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># First - load the data and take a look at what information is available</span><span class="w">
</span><span class="n">carSpeeds</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/car-speeds.csv'</span><span class="p">)</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">carSpeeds</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Color Speed     State
1  Blue    32 NewMexico
2   Red    45   Arizona
3  Blue    35  Colorado
4 White    34   Arizona
5   Red    25   Arizona
6  Blue    41   Arizona
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Next use indexing to replace all `Blue` entries in the Color column with 'Green'</span><span class="w">
</span><span class="n">carSpeeds</span><span class="o">$</span><span class="n">Color</span><span class="p">[</span><span class="n">carSpeeds</span><span class="o">$</span><span class="n">Color</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'Blue'</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Green'</span><span class="w">
</span></code></pre></div></div>

<div class="error highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Warning in `[&lt;-.factor`(`*tmp*`, carSpeeds$Color == "Blue", value =
structure(c(NA, : invalid factor level, NA generated
</code></pre></div></div>

<p> </p>

<p>What happened? The colors of the cars were loaded as factors by <code class="highlighter-rouge">read.csv(...)</code> by default. Since <code class="highlighter-rouge">Green</code> was not in the original set of colors, it was not included as a level in the factor.</p>

<p>To see the internal structure, we can use another function, <code class="highlighter-rouge">str()</code>. In this case,
the dataframe’s internal structure includes the format of each column, which is what
we are interested in.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">str</span><span class="p">(</span><span class="n">carSpeeds</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'data.frame':	100 obs. of  3 variables:
 $ Color: Factor w/ 5 levels " Red","Black",..: NA 1 NA 5 4 NA NA 2 5 4 ...
 $ Speed: int  32 45 35 34 25 41 34 29 31 26 ...
 $ State: Factor w/ 4 levels "Arizona","Colorado",..: 3 1 2 1 1 1 3 2 1 2 ...
</code></pre></div></div>

<p> </p>

<p>We can see that the <code class="highlighter-rouge">$Color</code> and <code class="highlighter-rouge">$State</code> columns are factors and <code class="highlighter-rouge">$Speed</code> is a numeric column.</p>

<p>One way to solve this problem would be to add the <code class="highlighter-rouge">Green</code> level to the <code class="highlighter-rouge">Color</code> factor, but there is a simpler way. Let’s reload the dataset using <code class="highlighter-rouge">stringsAsFactors = FALSE</code>, and see what happens when we try to replace ‘Blue’ with ‘Green’ in the <code class="highlighter-rouge">$Color</code> column:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># First - load the data and take a look at what information is available</span><span class="w">
</span><span class="n">carSpeeds</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/car-speeds.csv'</span><span class="p">,</span><span class="w"> </span><span class="n">stringsAsFactors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="n">str</span><span class="p">(</span><span class="n">carSpeeds</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'data.frame':	100 obs. of  3 variables:
 $ Color: chr  "Blue" " Red" "Blue" "White" ...
 $ Speed: int  32 45 35 34 25 41 34 29 31 26 ...
 $ State: chr  "NewMexico" "Arizona" "Colorado" "Arizona" ...
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Next use indexing to replace all `Blue` entries in the Color column with 'Green'</span><span class="w">
</span><span class="n">carSpeeds</span><span class="o">$</span><span class="n">Color</span><span class="p">[</span><span class="n">carSpeeds</span><span class="o">$</span><span class="n">Color</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'Blue'</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Green'</span><span class="w">
</span><span class="n">carSpeeds</span><span class="o">$</span><span class="n">Color</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [1] "Green" " Red"  "Green" "White" "Red"   "Green" "Green" "Black"
  [9] "White" "Red"   "Red"   "White" "Green" "Green" "Black" "Red"  
 [17] "Green" "Green" "White" "Green" "Green" "Green" "Red"   "Green"
 [25] "Red"   "Red"   "Red"   "Red"   "White" "Green" "Red"   "White"
 [33] "Black" "Red"   "Black" "Black" "Green" "Red"   "Black" "Red"  
 [41] "Black" "Black" "Red"   "Red"   "White" "Black" "Green" "Red"  
 [49] "Red"   "Black" "Black" "Red"   "White" "Red"   "Green" "Green"
 [57] "Black" "Green" "White" "Black" "Red"   "Green" "Green" "White"
 [65] "Black" "Red"   "Red"   "Black" "Green" "White" "Green" "Red"  
 [73] "White" "White" "Green" "Green" "Green" "Green" "Green" "White"
 [81] "Black" "Green" "White" "Black" "Black" "Red"   "Red"   "White"
 [89] "White" "White" "White" "Red"   "Red"   "Red"   "White" "Black"
 [97] "White" "Black" "Black" "White"
</code></pre></div></div>

<p> </p>

<p>That’s better! And we can see how the data now is read as character instead of factor.</p>

<hr />
<h3 id="writing-tabular-data-to-a-file-csv-txt">Writing tabular data to a file (.csv, .txt)</h3>

<p>After altering our cars dataset by replacing ‘Blue’ with ‘Green’ in the <code class="highlighter-rouge">$Color</code> column, we now want to save the output. The <code class="highlighter-rouge">read.table(...)</code> function family has a corresponding set of <code class="highlighter-rouge">write.table(...)</code> functions. These functions have a familiar set of arguments:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">?</span><span class="n">read.table</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>Here is the basic format for writing a table:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Export the data. The write.csv() function requires a minimum of two</span><span class="w">
</span><span class="c1"># arguments, the data to be saved and the name of the output file.</span><span class="w">

</span><span class="n">write.csv</span><span class="p">(</span><span class="n">carSpeeds</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/car-speeds-cleaned.csv'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>If you open the file, you’ll see that it has header names, because the data had headers within R, but that there are also numbers in the first column.</p>

<p><img src="../fig/01-supp-csv-with-row-nums.png" title="plot of chunk unnamed-chunk-14" alt="plot of chunk unnamed-chunk-14" width="350px" style="display: block; margin: auto auto auto 0;" /></p>

<p> </p>

<p>This extra column can cause problems when trying to open data in some other programs, and in most cases you won’t want to explicity name the rows. This can be easily disabled with a simple argument:</p>

<p> </p>
<h4 id="the-rownames-argument">The <code class="highlighter-rouge">row.names</code> Argument</h4>

<p>This argument allows us to set the names of the rows in the output data file. R’s default for this argument is <code class="highlighter-rouge">TRUE</code>, and since it does not know what else to name the rows for the cars data set, it resorts to using row numbers. To turn row numbers off, we can set <code class="highlighter-rouge">row.names</code> to <code class="highlighter-rouge">FALSE</code>:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">write.csv</span><span class="p">(</span><span class="n">carSpeeds</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/car-speeds-cleaned.csv'</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>Now we see:</p>

<p><img src="../fig/01-supp-csv-without-row-nums.png" title="plot of chunk unnamed-chunk-16" alt="plot of chunk unnamed-chunk-16" width="350px" style="display: block; margin: auto auto auto 0;" /></p>

<p> </p>

<blockquote class="callout">
  <h2 id="setting-column-names">Setting Column Names</h2>

  <p>There is also a <code class="highlighter-rouge">col.names</code> argument, which can be used to set the column
names for a data set without headers. If the data set already has headers
(e.g., we used the <code class="highlighter-rouge">headers = TRUE</code> argument when importing the data) then a
<code class="highlighter-rouge">col.names</code> argument will be ignored.</p>
</blockquote>

<p> </p>
<h4 id="the-na-argument">The <code class="highlighter-rouge">na</code> Argument</h4>

<p>There are times when we want to specify certain values for <code class="highlighter-rouge">NA</code>s in the data set (e.g., we are going to pass the data to a program that only accepts -9999 as a nodata value). In this case, we want to set the <code class="highlighter-rouge">NA</code> value of our output file to the desired value, using the na argument. Let’s see how this works:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># First, replace the speed in the 3rd row with NA, by using an index (square</span><span class="w">
</span><span class="c1"># brackets to indicate the position of the value we want to replace)</span><span class="w">
</span><span class="n">carSpeeds</span><span class="o">$</span><span class="n">Speed</span><span class="p">[</span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">carSpeeds</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Color Speed     State
1 Green    32 NewMexico
2   Red    45   Arizona
3 Green    NA  Colorado
4 White    34   Arizona
5   Red    25   Arizona
6 Green    41   Arizona
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">write.csv</span><span class="p">(</span><span class="n">carSpeeds</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/car-speeds-cleaned.csv'</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>Now we’ll set <code class="highlighter-rouge">NA</code> to -9999 when we write the new .csv file:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Note - the na argument requires a string input</span><span class="w">
</span><span class="n">write.csv</span><span class="p">(</span><span class="n">carSpeeds</span><span class="p">,</span><span class="w">
          </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/car-speeds-cleaned.csv'</span><span class="p">,</span><span class="w">
          </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w">
          </span><span class="n">na</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'-9999'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>And we see:</p>

<p><img src="../fig/01-supp-csv-with-special-NA.png" title="plot of chunk unnamed-chunk-19" alt="plot of chunk unnamed-chunk-19" width="350px" style="display: block; margin: auto auto auto 0;" /></p>

<p> </p>

<p>This can be useful when exporting data from R in a different program that either does not recognize <code class="highlighter-rouge">NA</code> or uses a different symbol for missing data.</p>

<hr />
<h3 id="calculating-basic-statistics">Calculating basic statistics</h3>

<p>Now let’s perform some common mathematical operations to learn more about our data. Before we begin, let’s clean up our environment and reload our sample data to reset any unintended changes and be sure that we include <code class="highlighter-rouge">header=TRUE</code> and <code class="highlighter-rouge">stringsAsFactors=FALSE</code>.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rm</span><span class="p">(</span><span class="n">list</span><span class="o">=</span><span class="n">ls</span><span class="p">())</span><span class="w">
</span><span class="n">dat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s2">"data/sample.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">stringsAsFactors</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>This data is the results of an (not real) experiment, looking at the number of aneurisms that formed in the eyes of patients who undertook 3 different treatments.</p>

<p>When analyzing data we often want to look at partial statistics, such as the maximum value per patient or the average value per treatment group. One way to do this is to select the data we want to create a new temporary data frame, and then perform the calculation on this subset:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># select aneurism data for the first subject</span><span class="w">
</span><span class="n">sub1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dat</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="o">:</span><span class="m">9</span><span class="p">]</span><span class="w">

</span><span class="c1"># max number of aneurisms for subject 1</span><span class="w">
</span><span class="nf">max</span><span class="p">(</span><span class="n">sub1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 237
</code></pre></div></div>

<p> </p>

<p>We don’t actually need to store the row in a variable of its own.
Instead, we can combine the selection and the function call:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># max inflammation for subject 2</span><span class="w">
</span><span class="nf">max</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="o">:</span><span class="m">9</span><span class="p">])</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 248
</code></pre></div></div>

<p> </p>

<p>R also has functions for other common calculations, e.g. finding the minimum, mean, median, and standard deviation of the data:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># minimum number of aneurisms in q3</span><span class="w">
</span><span class="nf">min</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Aneurisms_q3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 105
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># mean number of aneurisms in q3</span><span class="w">
</span><span class="n">mean</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Aneurisms_q3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 219.85
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># median number of aneurisms in q3</span><span class="w">
</span><span class="n">median</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Aneurisms_q3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 217
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># standard deviation number of aneurisms in q3</span><span class="w">
</span><span class="n">sd</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Aneurisms_q3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 48.76958
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># total number of observations in q3</span><span class="w">
</span><span class="nf">length</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Aneurisms_q3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 100
</code></pre></div></div>

<p> </p>

<p>R has a function called <code class="highlighter-rouge">summary()</code> that provides a convenient summary of each column:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Summarize function</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      ID               Gender             Group           BloodPressure  
 Length:100         Length:100         Length:100         Min.   : 62.0  
 Class :character   Class :character   Class :character   1st Qu.:107.5  
 Mode  :character   Mode  :character   Mode  :character   Median :117.5  
                                                          Mean   :118.6  
                                                          3rd Qu.:133.0  
                                                          Max.   :173.0  
      Age         Aneurisms_q1    Aneurisms_q2    Aneurisms_q3  
 Min.   :12.10   Min.   : 65.0   Min.   : 80.0   Min.   :105.0  
 1st Qu.:14.78   1st Qu.:118.0   1st Qu.:131.5   1st Qu.:182.5  
 Median :16.65   Median :158.0   Median :162.5   Median :217.0  
 Mean   :16.42   Mean   :158.8   Mean   :168.0   Mean   :219.8  
 3rd Qu.:18.30   3rd Qu.:188.0   3rd Qu.:196.8   3rd Qu.:248.2  
 Max.   :20.00   Max.   :260.0   Max.   :283.0   Max.   :323.0  
  Aneurisms_q4  
 Min.   :116.0  
 1st Qu.:186.8  
 Median :219.0  
 Mean   :217.9  
 3rd Qu.:244.2  
 Max.   :315.0  
</code></pre></div></div>

<p> </p>

<p>For every column in the data frame, <code class="highlighter-rouge">summary()</code> provides a different of summary data depending on the class of that column. For instance, for <code class="highlighter-rouge">numeric</code> columns, <code class="highlighter-rouge">summary()</code> provides minimun, maximum, mean, median, and quartile values.</p>

<p>What if we need the maximum number of aneurisms across quarters for each patient, or perhaps the average across quarters? As the diagram below shows, we want to perform the operation across a <code class="highlighter-rouge">margin</code> of the data frame; that is we want to perform the same function (<code class="highlighter-rouge">mean()</code>) on the last 4 columns for every row:</p>

<p><img src="../fig/r-operations-across-margins.svg" alt="Operations Across Margins" /></p>

<p>To support this, we can use the <code class="highlighter-rouge">apply</code> function.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">?</span><span class="n">apply</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p><code class="highlighter-rouge">apply</code> allows us to repeat a function on all of the rows (<code class="highlighter-rouge">MARGIN = 1</code>) or columns (<code class="highlighter-rouge">MARGIN = 2</code>) of a data frame. Thus, to obtain the average inflammation of each patient we will need to calculate the mean of all of the rows (<code class="highlighter-rouge">MARGIN = 1</code>) of the data frame.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">avg_aneurisms_subject</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">[,</span><span class="m">6</span><span class="o">:</span><span class="m">9</span><span class="p">],</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>And to obtain the average number of aneurisms for each quarter, mean of all of the columns (<code class="highlighter-rouge">MARGIN = 2</code>) of the data frame:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">avg_aneurisms_quarter</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">[,</span><span class="m">6</span><span class="o">:</span><span class="m">9</span><span class="p">],</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<blockquote class="callout">
  <h2 id="argument-order-in-functions">Argument Order in Functions</h2>

  <p>Notice that we did not specify the argument names in <code class="highlighter-rouge">apply()</code>. Looking at the help file, the argument 
order is <code class="highlighter-rouge">X</code> (indicating the input data), then <code class="highlighter-rouge">MARGIN</code>, then <code class="highlighter-rouge">FUN</code> (for function to apply). So long as you 
enter arguments in the requested order, you do not need to be explicitly about which argument you are 
referring too. <code class="highlighter-rouge">apply()</code> just assumes that the first argument entered is the value for <code class="highlighter-rouge">X</code>, the second is the &gt; value for <code class="highlighter-rouge">MARGIN</code>, and the third is the value for <code class="highlighter-rouge">FUN</code>. You can mix up the order, but then you have to be 
explicit about which argument you are defining.</p>

  <p>For example, this will return an error:</p>

  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">avg_aneurisms_subject</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">dat</span><span class="p">[,</span><span class="m">6</span><span class="o">:</span><span class="m">9</span><span class="p">])</span><span class="w">
</span></code></pre></div>  </div>

  <p>while this will be interpreted identically to the earlier function call:</p>

  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">avg_aneurisms_subject</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">FUN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="n">MARGIN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dat</span><span class="p">[,</span><span class="m">6</span><span class="o">:</span><span class="m">9</span><span class="p">])</span><span class="w">
</span></code></pre></div>  </div>
</blockquote>

<p> </p>

<blockquote class="callout">
  <h2 id="efficient-alternatives">Efficient Alternatives</h2>

  <p>Some common operations have more efficient alternatives. For example, you
can calculate the row-wise or column-wise means with <code class="highlighter-rouge">rowMeans()</code> and
<code class="highlighter-rouge">colMeans()</code>, respectively. Similarly for <code class="highlighter-rouge">rowSums()</code> and <code class="highlighter-rouge">colSums()</code>.</p>
</blockquote>

<p> </p>
<h4 id="exercises">Exercises</h4>

<blockquote class="challenge">
  <h2 id="subsetting-more-data">Subsetting More Data</h2>

  <p>Suppose you want to determine the maximum number of aneurisms for subject 5 across quarters two to four.
To do this you would extract the relevant subset from the data frame and calculate the maximum value.
Which of the following lines of R code gives the correct answer?</p>

  <ol>
    <li><code class="highlighter-rouge">max(dat[5, ])</code></li>
    <li><code class="highlighter-rouge">max(dat[7:9, 5])</code></li>
    <li><code class="highlighter-rouge">max(dat[5, 7:9])</code></li>
    <li><code class="highlighter-rouge">max(dat[5, 7, 9])</code></li>
  </ol>

  <blockquote class="solution">
    <h2 id="solution-2">Solution</h2>

    <p>Answer: 3</p>

    <p>Explanation: You want to extract the part of the data frame representing data for patient 5 from quarter two (column 7) to quarter 4 (column 9). In this data frame, patient data is organised in rows and the days are represented by the columns. Subscripting in R follows the <code class="highlighter-rouge">[i, j]</code> principle, where <code class="highlighter-rouge">i = rows</code> and <code class="highlighter-rouge">j = columns</code>. Thus, answer 3 is correct since the patient is represented by the value for i (5) and the days are represented by the values in j, which is a subset spanning day 9 to 7.</p>

  </blockquote>
</blockquote>

<blockquote class="challenge">
  <h2 id="subsetting-and-re-assignment">Subsetting and Re-Assignment</h2>

  <p>Using the data frame <code class="highlighter-rouge">dat</code> from above:
Let’s pretend there was something wrong with the instrument on the first two quarters for every second patient (subjects 2, 4, 6, etc.), which resulted in the measurements being twice as large as they should be.</p>

  <ol>
    <li>Write a vector containing each affected patient (hint: <code class="highlighter-rouge">?seq</code>)</li>
    <li>Create a new data frame in which you halve the first two quarters’ values in only those patients</li>
    <li>Print out the corrected data frame to check that your code has fixed the problem</li>
  </ol>

  <blockquote class="solution">
    <h2 id="solution-3">Solution</h2>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">whichPatients</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="nf">dim</span><span class="p">(</span><span class="n">dat</span><span class="p">)[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="c1"># i.e., which rows</span><span class="w">
</span><span class="n">whichQuarters</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="m">7</span><span class="p">)</span><span class="w">         </span><span class="c1"># i.e., which columns indicates quarters 1 and 2; you could also use c(6,7) or 6:7</span><span class="w">
</span><span class="n">dat2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dat</span><span class="w"> </span><span class="c1"># make a copy of the original data</span><span class="w">
</span><span class="c1"># check the size of your subset: returns `30 5`, that is 30 [rows=patients] by 5 [columns=quarters]</span><span class="w">
</span><span class="nf">dim</span><span class="p">(</span><span class="n">dat2</span><span class="p">[</span><span class="n">whichPatients</span><span class="p">,</span><span class="w"> </span><span class="n">whichQuarters</span><span class="p">])</span><span class="w">
</span></code></pre></div>    </div>

    <div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 50  2
</code></pre></div>    </div>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dat2</span><span class="p">[</span><span class="n">whichPatients</span><span class="p">,</span><span class="w"> </span><span class="n">whichQuarters</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dat</span><span class="p">[</span><span class="n">whichPatients</span><span class="p">,</span><span class="w"> </span><span class="n">whichQuarters</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span><span class="w">
</span><span class="n">dat2</span><span class="w">
</span></code></pre></div>    </div>

    <div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        ID Gender      Group BloodPressure  Age Aneurisms_q1 Aneurisms_q2
1   Sub001      m    Control           132 16.0        114.0        140.0
2   Sub002      m Treatment2           139 17.2         74.0        104.5
3   Sub003      m Treatment2           130 19.5        196.0        251.0
4   Sub004      f Treatment1           105 15.7         99.5         70.0
5   Sub005      m Treatment1           125 19.9        188.0        120.0
6   Sub006      M Treatment2           112 14.3        130.0        133.0
7   Sub007      f    Control           173 17.7        135.0         98.0
8   Sub008      m Treatment2           108 19.8        108.0        119.0
9   Sub009      m Treatment2           131 19.4        117.0        215.0
10  Sub010      f    Control           129 18.8         94.0         72.0
11  Sub011      m Treatment1           126 14.8        134.0        155.0
12  Sub012      f Treatment2            96 15.3         76.0         88.5
13  Sub013      f    Control            77 16.5        112.0        220.0
14  Sub014      m    Control           158 12.6         54.5         75.0
15  Sub015      m    Control            81 14.3        146.0        140.0
16  Sub016      m    Control           137 15.9         48.5         86.0
17  Sub017      f Treatment1           147 18.4        165.0        157.0
18  Sub018      m Treatment2           130 18.3         79.0        132.5
19  Sub019      m Treatment1           105 15.4        178.0        109.0
20  Sub020      F Treatment1            92 14.3         53.5         94.0
21  Sub021      f    Control           111 12.7        174.0        160.0
22  Sub022      m Treatment1           122 15.4         48.5         55.0
23  Sub023      f Treatment2            97 17.2        187.0        239.0
24  Sub024      f Treatment2           118 17.3         94.0         95.5
25  Sub025      m Treatment1            82 16.7        114.0        199.0
26  Sub026      M Treatment1           123 19.6         57.5         80.0
27  Sub027      M Treatment2           126 15.0        128.0        249.0
28  Sub028      f Treatment1            94 16.1         56.0        115.0
29  Sub029      m    Control           135 17.6        136.0        109.0
30  Sub030      f    Control           108 18.6         51.5         74.0
31  Sub031      f Treatment1           133 18.3        132.0        151.0
32  Sub032      m Treatment1           108 16.7         59.0         77.0
33  Sub033      m Treatment2           122 12.5        166.0        176.0
34  Sub034      m Treatment1           134 14.3         76.0         52.5
35  Sub035      m Treatment1           145 19.7        191.0        148.0
36  Sub036      f    Control           133 17.6         76.0         89.0
37  Sub037      f Treatment2            90 17.0        161.0        270.0
38  Sub038      m Treatment2           118 12.2        119.5         92.0
39  Sub039      M Treatment1           113 15.1        132.0        137.0
40  Sub040      m Treatment2           115 17.7         84.0        127.5
41  Sub041      f Treatment1           142 19.0        140.0        184.0
42  Sub042      m Treatment1           114 14.7         83.0         42.5
43  Sub043      m    Control           139 15.2        141.0        160.0
44  Sub044      m Treatment1            90 15.3         80.5         84.0
45  Sub045      f    Control           126 12.9        103.0        111.0
46  Sub046      f Treatment2           109 18.4        115.5        120.0
47  Sub047      M    Control           125 18.1        192.0        141.0
48  Sub048      M    Control            99 15.6         89.0         90.0
49  Sub049      m    Control           122 19.5        167.0        123.0
50  Sub050      m Treatment1           111 13.5         67.5         75.0
51  Sub051      m Treatment2           109 13.5        150.0        166.0
52  Sub052      f Treatment1           134 13.7         96.0         40.0
53  Sub053      f Treatment1           113 18.7        153.0        153.0
54  Sub054      f Treatment2           105 12.2        102.5        132.0
55  Sub055      m Treatment2           125 16.9        117.0        194.0
56  Sub056      f Treatment2           123 19.5         99.5         59.5
57  Sub057      m    Control           155 12.1        182.0        129.0
58  Sub058      m Treatment2           117 17.0         90.0         98.0
59  Sub059      m Treatment1           116 19.2        111.0        111.0
60  Sub060      f    Control           133 14.7         50.5         49.0
61  Sub061      f    Control            94 20.0        166.0        167.0
62  Sub062      f Treatment2           106 14.1         79.0         85.5
63  Sub063      f Treatment1           144 14.7        189.0        178.0
64  Sub064      M Treatment1           149 16.6         94.5         50.5
65  Sub065      f Treatment2           108 15.0        239.0        189.0
66  Sub066      m Treatment1           116 15.0         92.5        112.0
67  Sub067      f Treatment2           136 13.8        224.0        112.0
68  Sub068      f    Control            98 14.8         52.0         69.5
69  Sub069      M Treatment2           148 19.1        222.0        199.0
70  Sub070      m    Control            74 18.9         53.5         49.0
71  Sub071      m Treatment2           147 17.7        153.0        255.0
72  Sub072      m    Control           116 17.4         59.0         82.5
73  Sub073      F Treatment1           133 15.5        102.0        184.0
74  Sub074      m    Control            97 13.1         94.0         62.5
75  Sub075      m Treatment2           132 12.2        180.0        283.0
76  Sub076      f Treatment2           153 17.0         89.0        107.0
77  Sub077      M Treatment1           151 17.7        168.0        184.0
78  Sub078      M Treatment1           121 19.5         59.0         85.0
79  Sub079      M Treatment1           116 19.5        169.0        114.0
80  Sub080      f    Control           104 12.8         78.0         69.0
81  Sub081      m Treatment2           111 17.6        232.0        211.0
82  Sub082      M Treatment1            62 17.7         94.0         54.0
83  Sub083      M Treatment2           124 14.2        169.0        168.0
84  Sub084      m Treatment2           124 19.2        120.5        116.5
85  Sub085      m Treatment2           109 16.0         65.0        207.0
86  Sub086      f    Control           117 15.2        112.5         92.5
87  Sub087      f    Control            90 17.6        104.0        116.0
88  Sub088      f Treatment1           158 17.6         89.5         79.0
89  Sub089      m Treatment1           113 15.1        103.0        140.0
90  Sub090      m    Control           150 17.8         56.0         65.0
91  Sub091      f Treatment2           115 16.2        226.0        170.0
92  Sub092      m Treatment2            83 16.6        114.0        110.5
93  Sub093      F    Control           116 19.1        209.0        142.0
94  Sub094      f Treatment1           141 17.2         76.5         52.0
95  Sub095      m    Control           108 13.6        111.0        118.0
96  Sub096      m    Control           102 14.6         74.0         66.0
97  Sub097      F Treatment2            90 19.6        141.0        196.0
98  Sub098      m Treatment1           133 17.0         96.5         56.0
99  Sub099      M Treatment2            83 16.2        130.0        226.0
100 Sub100      M Treatment1           122 18.4         63.0         78.5
    Aneurisms_q3 Aneurisms_q4
1            202          237
2            248          248
3            122          177
4            233          220
5            222          228
6            320          294
7            154          245
8            279          251
9            181          272
10           192          185
11           247          223
12           323          245
13           225          195
14           177          189
15           239          223
16           203          207
17           200          193
18           243          187
19           206          182
20           167          218
21           203          183
22           194          133
23           281          214
24           256          265
25           242          195
26           158          228
27           294          315
28           281          126
29           105          155
30           219          228
31           234          162
32           260          160
33           253          233
34           197          299
35           166          185
36           158          170
37           232          284
38           317          269
39           193          206
40           273          274
41           239          202
42           179          196
43           179          239
44           212          181
45           254          126
46           260          310
47           180          225
48           169          183
49           236          224
50           208          279
51           153          204
52           138          222
53           236          216
54           269          207
55           216          211
56           183          251
57           226          218
58           250          294
59           244          201
60           178          116
61           232          241
62           237          212
63           177          238
64           193          172
65           297          300
66           151          182
67           304          288
68           211          204
69           280          196
70           204          138
71           218          234
72           220          227
73           246          222
74           191          157
75           204          298
76           291          240
77           184          229
78           249          249
79           248          233
80           218          258
81           219          246
82           180          136
83           180          211
84           292          182
85           234          235
86           195          235
87           173          221
88           216          244
89           209          186
90           175          191
91           307          244
92           316          259
93           199          184
94           194          214
95           173          191
96           200          194
97           322          273
98           123          181
99           286          281
100          129          160
</code></pre></div>    </div>
  </blockquote>
</blockquote>

<blockquote class="challenge">
  <h2 id="correcting-case-in-gender">Correcting Case in Gender</h2>

  <p>Take a closer look at the gender break down of our aneurism patient group.
You can use the <code class="highlighter-rouge">table()</code> function to give you a count of each category for a 
categorical vector:</p>

  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">table</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Gender</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>

  <div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
 f  F  m  M 
35  4 46 15 
</code></pre></div>  </div>

  <p>What is going on here? It appears that the person entering this data sometimes
used <code class="highlighter-rouge">m</code> and sometimes <code class="highlighter-rouge">M</code> to indicate <code class="highlighter-rouge">male</code>, and similarly <code class="highlighter-rouge">f</code> or <code class="highlighter-rouge">F</code> to 
indicate <code class="highlighter-rouge">female</code> (or perhaps there were two individuals entering the data
in slightly different ways). This is a problem, because R is case-sensitive and
treats <code class="highlighter-rouge">m</code> as a different entry from <code class="highlighter-rouge">M</code>.</p>

  <p>Use logical indexing to correct this problem. So we are all on the same page,
change all entries to capitals. Save your corrected file to the data folder under
the file name “sample-gendercorrected.csv”.</p>

  <blockquote class="solution">
    <h2 id="solution-4">Solution</h2>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># first make a copy of the data (never overwrite your raw data)</span><span class="w">
</span><span class="n">dat_cor</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dat</span><span class="w">

</span><span class="c1"># correct `f` entries to `F`</span><span class="w">
</span><span class="n">dat_cor</span><span class="o">$</span><span class="n">Gender</span><span class="p">[</span><span class="n">dat_cor</span><span class="o">$</span><span class="n">Gender</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'f'</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'F'</span><span class="w">

</span><span class="c1"># correct `m` entries to `M`</span><span class="w">
</span><span class="n">dat_cor</span><span class="o">$</span><span class="n">Gender</span><span class="p">[</span><span class="n">dat_cor</span><span class="o">$</span><span class="n">Gender</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'m'</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'M'</span><span class="w">

</span><span class="c1"># check the output using `table()`</span><span class="w">
</span><span class="n">table</span><span class="p">(</span><span class="n">dat_cor</span><span class="o">$</span><span class="n">Gender</span><span class="p">)</span><span class="w">

</span><span class="c1"># save corrected data file</span><span class="w">
</span><span class="n">write.csv</span><span class="p">(</span><span class="n">dat_cor</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="o">=</span><span class="s2">"data/sample-gendercorrected.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
  </blockquote>
</blockquote>

<blockquote class="challenge">
  <h2 id="using-the-apply-function-on-patient-data">Using the Apply Function on Patient Data</h2>

  <p>The apply function can be used to summarize datasets and subsets
of data across rows and columns using the MARGIN argument.
Suppose you want to calculate the mean number of aneurisms for 
specific quarters and patients in the patient dataset.</p>

  <p>Use a combination of the apply function and indexing to:</p>

  <ol>
    <li>Calculate the mean number of aneurisms for patients 1 to 5 over all four quarters.</li>
    <li>Calculate the mean number of aneurisms for quarters 1 to 3 (across all patients).</li>
    <li>Calculate the mean number of aneurisms for each patient in treatment group 2 day (across all quarters).</li>
  </ol>

  <p>Think about the number of rows and columns you would expect as the result before each apply call and check your intuition by applying the mean function.</p>

  <blockquote class="solution">
    <h2 id="solution-5">Solution</h2>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="c1"># 1.</span><span class="w">
</span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="o">:</span><span class="m">9</span><span class="p">],</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w">

</span><span class="c1"># 2.</span><span class="w">
</span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">[,</span><span class="w"> </span><span class="m">6</span><span class="o">:</span><span class="m">8</span><span class="p">],</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w">

</span><span class="c1"># 3.</span><span class="w">
</span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="n">dat</span><span class="o">$</span><span class="n">Group</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Treatment2"</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="o">:</span><span class="m">9</span><span class="p">],</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
  </blockquote>
</blockquote>

<hr />
<h3 id="plotting">Plotting</h3>

<p>The mathematician Richard Hamming once said,</p>

<p>      <em>“The purpose of computing is insight, not numbers.”</em></p>

<p>The best way to develop insight is often to visualize data. Visualization deserves an entire lecture (or course) of its own, and we will touch on various aspects of R’s plotting functionality later on in the course, but for now we will introduce a few of R’s plotting features.</p>

<p>The basic plot function in R is called, conveniently, <code class="highlighter-rouge">plot()</code>. Let’s take a quick look:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">?</span><span class="n">plot</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>In it’s most basic form, <code class="highlighter-rouge">plot(x,y)</code> function will create a scatter plot with points defined by the vectors <code class="highlighter-rouge">x</code> and <code class="highlighter-rouge">y</code>. Let’s start out with the iris data set and look at the relationship between petal length and width:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-35-1.png" title="plot of chunk unnamed-chunk-35" alt="plot of chunk unnamed-chunk-35" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>Congratulations! You have plotted your first data in R. So what is going on in the background here? Let’s talk about what R is actually doing when you give it the plot command.</p>

<p> </p>
<h4 id="graphics-devices">Graphics devices</h4>

<p>When you tell R to run a plot, it actually takes a series of actions:</p>

<ol>
  <li>Opens a new “graphics device”. This device can be one of several things:
 a. The “Plot” section in the lower-right panel of RStudio (this is the default in RStudio).
 b. A blank graphics pane in a new window (this requires the <code class="highlighter-rouge">windows()</code> or <code class="highlighter-rouge">quartz()</code> commands, which we discuss below).
 c. An external image file (e.g. a new .jpg file).
 d. An external PDF file (complete with vector graphics!).</li>
  <li>Draws a series of objects; this part is done “under the hood” of the <code class="highlighter-rouge">plot()</code> function, and includes:
 a. Axes.
 b. Tick marks.
 c. Axis labels.
 d. Data points.
 e. Legend(s).
 f. Chart titles.</li>
  <li>Leaves the current graphics device open for additional drawing input. This step is important, because it means that you can continue to add things to the image using other functions.</li>
  <li>Closes the graphics device following a <code class="highlighter-rouge">dev.off()</code> function call. This essentially “finalizes” the image.</li>
</ol>

<p>Note that you can have multiple graphics devices open at once. R will, by default, write new graphics to the most recently used or created graphics device. Some functions, like <code class="highlighter-rouge">plot()</code> automatically start a new graphics device (or page in the case of the RStudio panel or a PDF), while other functions, like <code class="highlighter-rouge">lines()</code>, will add graphical elements to the most recently used device.</p>

<p>Let’s repeat our above <code class="highlighter-rouge">plot()</code> command in a few different devices to illustrate a few of these points.</p>

<p> </p>

<p><strong>Plotting in a separate window</strong></p>

<p>To plot in a separate window within RStudio (rather than the “Plot” panel), use one of the following platform-dependent functions:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">windows</span><span class="p">()</span><span class="w"> </span><span class="c1"># Windows</span><span class="w">
</span><span class="n">quartz</span><span class="p">()</span><span class="w"> </span><span class="c1"># MacOS</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>Now recreate our above plot:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-37-1.png" title="plot of chunk unnamed-chunk-37" alt="plot of chunk unnamed-chunk-37" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>Note that we can now add additional elements to this plot. Let’s add a chart title to demonstrate the point.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">title</span><span class="p">(</span><span class="s2">"Relationship between petal length and petal width"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-38-1.png" title="plot of chunk unnamed-chunk-38" alt="plot of chunk unnamed-chunk-38" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>We can shutdown the window by either just closing it, or from RStudio using the <code class="highlighter-rouge">dev.off()</code> function.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dev.off</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>null device 
          1 
</code></pre></div></div>

<p><strong>Plotting to an external file</strong></p>

<p>R has a series of functions designed to open a graphics device that will write directly to an external file. These files can be image files or PDFs.</p>
<ul>
  <li><code class="highlighter-rouge">bmp()</code> generates a <em>.bmp</em></li>
  <li><code class="highlighter-rouge">jpeg()</code> generates a <em>.jpg</em></li>
  <li><code class="highlighter-rouge">png()</code> generates a <em>.png</em></li>
  <li><code class="highlighter-rouge">tiff()</code> generates a <em>.tif</em></li>
  <li><code class="highlighter-rouge">pdf()</code> generates a <em>.pdf</em></li>
</ul>

<p>The first four are all versions of the same function and behave essentially interchangably. PDF is a separate function. The primary difference between the two is that the non-PDF image files will have a defined resolution, while the PDF files are generated as <em>vector graphics</em>, meaning that they maintain resolution at any size.</p>

<blockquote class="callout">
  <h2 id="vector-graphics">Vector Graphics</h2>

  <p>Traditional image formats (e.g. .bmp, .jpg, .tiff, .png) are, in essence, a two dimensional array of color and intensity values (such as 
red-green-blue, or RGB values). The array has a fixed number of pixels in each dimension, so if you take an image that is 1 in x 1 in with 
100 pixels in each dimension, and blow it up to 1 ft x ft, it still only has 100 pixels in each dimension. The blowup image will appear 
blocky, or “pixelated”.</p>

  <p>Vector graphics are distinct from traditional graphics in that they are defined by a set of mathematical operations carried out at specified &gt; coordinates. For example, two of the instructions may be something like:</p>
  <ol>
    <li>Draw the letter “A” in normal size 10 Arial font at coordinates (10, 10).</li>
    <li>Draw the an arrow with line weight 2 and arrow head style X size 4 from the point (12, 12) to the point (20, 20).</li>
  </ol>

  <p>These instructions are the same for a 1 in x 1 in image and a 1 ft x 1 ft image (or a 1 mile x 1 mile image). Because the shape of the 
letter and the arrow are defined by the font and the arrow head style, when the image is rendered, they can be drawn with the appropriate 
number of pixels to appear crisp and smooth at the image size requested.</p>

  <p>This is how PDF files and other vector graphic formats work. They are really convenient for preparing manuscripts because journals often 
want a low-res file for review and a high-res file for publication. By starting with a PDF you can generate both categories of graphic with 
the same underlying file. any modern journals prefer that figures be submitted as PDF or other vector graphics format for this very reason.</p>
</blockquote>

<p> </p>

<p>Let’s give both types of graphic generation a try by generating our previous plot as a <em>.jpg** and **.PDF</em> file. Take a look at the <code class="highlighter-rouge">jpeg()</code> function to see what it needs:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">?</span><span class="n">jpeg</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>By default, the function will generate a plot with an automatically generated name in our home directory. Recall that we have already defined a separate <em>MCB585/results</em> folder, stored in memory under the <code class="highlighter-rouge">results.dir</code> variable. First we will generate a file name that contains both the path to our results directory and the name of the file we want. We can write this all out, or use the <code class="highlighter-rouge">paste()</code> function to combine the path and file name into a single <code class="highlighter-rouge">character</code> variable:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">results.dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"results"</span><span class="w"> </span><span class="c1"># in case you haven't defined it yet in this lesson</span><span class="w">
</span><span class="n">petal.cor.file</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="n">results.dir</span><span class="p">,</span><span class="w"> </span><span class="s2">"/petal-width-length-comparison.jpg"</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="o">=</span><span class="s2">""</span><span class="p">)</span><span class="w"> </span><span class="c1"># note that by default, paste() puts a space in between entries whten combining them into a string; thus we have to change the separator to "nothing" by setting sep = ""</span><span class="w">

</span><span class="n">petal.cor.file</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">paste0</span><span class="p">(</span><span class="n">results.dir</span><span class="p">,</span><span class="w"> </span><span class="s2">"/petal-width-length-comparison.jpg"</span><span class="p">)</span><span class="w"> </span><span class="c1"># paste0() is just like paste() with the separator automatically set to "nothing"</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>Also by default, the function will produce a 480 px x 480 px image at 72 pixels per inch (ppi). Note that the actual physical image size will be <strong>size inches = size in pixels/ppi</strong>. Let’s make a 100 ppi <em>.jpg</em> image that is 5 in x 5 in.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">jpeg</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">petal.cor.file</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">500</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">500</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>Now look inside your results folder. If the <code class="highlighter-rouge">jpeg()</code> function worked correctly and our directories were correct, you should now see a new file called <em>petal-width-length-comparison.jpg</em>. What happens when you try to open this file?</p>

<p>You should get an error at this point. This is because the file has been created, but that it is currently black and open in RStudio waiting for more input. We can use the <code class="highlighter-rouge">dev.cur()</code> to confirm that the active graphics device is indeed the JPEG file.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dev.cur</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>Let’s give it our earlier <code class="highlighter-rouge">plot()</code> and <code class="highlighter-rouge">title()</code> commands, and then turn off the device (using <code class="highlighter-rouge">dev.off()</code>) to complete and close the file.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">)</span><span class="w">
</span><span class="n">title</span><span class="p">(</span><span class="s2">"Relationship between petal length and petal width"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-44-1.png" title="plot of chunk unnamed-chunk-44" alt="plot of chunk unnamed-chunk-44" width="612" style="display: block; margin: auto;" /></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dev.off</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jpeg 
   3 
</code></pre></div></div>

<p> </p>

<p>Now try opening the <em>petal-width-length-comparison.jpg</em>. We have our chart in JPG format! Zoom in to check out the resolution. Not great? Generating JPEG or other graphics formats is useful for some applications (e.g. direct output to a webpage, for example), but for generating reports and paper figures, vector graphics are the way to go. That’s why I tend to work almost exclusively in PDF files, and so will we for the rest of the course.</p>

<p>So let’s do it. First let’s take a look at the <code class="highlighter-rouge">pdf()</code> function:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">?</span><span class="n">pdf</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>While <code class="highlighter-rouge">pdf()</code> still wants the file name as the <code class="highlighter-rouge">file = </code> argument, we now specify width and height in inches to define the size of the file, and exclude resolution because PDF files are vector graphics and will be generated to the resolution required by the size. This is more intuitive (we just ask for the image size that we way, instead of having to calculate it from pixel number and ppi), and more convenient. WE can now generate any size output we want, including a nice, printable 8.5 in x 11 in standard paper size.</p>

<p>For the moment, we will generate the PDF equivalent of our earlier JPEG, with dimensions of 5 in x 5 in. For fun, let’s also include a second plot that compares sepal length and width:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># define the file name</span><span class="w">
</span><span class="n">petal.cor.pdf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"results/petal-width-length-comparison.pdf"</span><span class="w">

</span><span class="c1"># generate the PDF file</span><span class="w">
</span><span class="n">pdf</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">petal.cor.pdf</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">)</span><span class="w">

</span><span class="c1"># plot petal length vs. width</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">)</span><span class="w">
</span><span class="n">title</span><span class="p">(</span><span class="s2">"Relationship between petal length and petal width"</span><span class="p">)</span><span class="w">

</span><span class="c1"># plot petal length vs. width</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Width</span><span class="p">)</span><span class="w">
</span><span class="n">title</span><span class="p">(</span><span class="s2">"Relationship between sepal length and sepal width"</span><span class="p">)</span><span class="w">

</span><span class="c1"># finalize the PDF</span><span class="w">
</span><span class="n">dev.off</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>Notice a couple of important things:</p>
<ul>
  <li>Zooming in and out in the PDF does not affect image resulution. It always looks sharp!</li>
  <li>Running <code class="highlighter-rouge">plot()</code> the second time generated a second page in the PDF file. If you want a new file for every figure, set <code class="highlighter-rouge">onefile = T</code> in the <code class="highlighter-rouge">pdf()</code> function (see the <code class="highlighter-rouge">?pdf</code> documentation for details).</li>
</ul>

<p> </p>
<h4 id="fixing-the-axis-labels">Fixing the axis labels</h4>

<p>Okay, so we know how to generate a chart. Clearly the default parameters are not what we want. First, what is up with the axis labels? By default, R will just use the variable name as the axis labels, having nothing else to work with. We can add out own labels with the <code class="highlighter-rouge">xlab</code> and <code class="highlighter-rouge">ylab</code> arguments.</p>

<p>For now, we will just use the plot window in RStudio to demonstrate a few of the features of <code class="highlighter-rouge">plot()</code>. To make sure you don’t have any open graphics devices, run <code class="highlighter-rouge">dev.off()</code> a few times before moving forward.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">,</span><span class="w">
     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Length (cm)"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Width (cm)"</span><span class="p">)</span><span class="w"> </span><span class="c1"># line wrap longer function calls for readability</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-47-1.png" title="plot of chunk unnamed-chunk-47" alt="plot of chunk unnamed-chunk-47" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>That’s better! Now, looking at the data, there does seem to be an odd pattern. There is clearly a distinct group in the lower left corner with smaller petals. Let’s remind ourselves what information we have available:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa
</code></pre></div></div>

<p> </p>

<p>The most obvious candidate to explain the separate grouping is species. We can add color to see if that grouping is all one species using the <code class="highlighter-rouge">col</code> argument. R has many color names available by default which can be listed using the <code class="highlighter-rouge">colors()</code> function and called using a simple character string (e.g. <code class="highlighter-rouge">"blue"</code>), which is how we will do it. You can also select colors by hex code or RGB value with other functions, details on which can be found on this helpful <a href="../fig/colorPaletteCheatsheet.pdf">R color guide</a>.</p>

<p>First, we can just specify a color for the whole plot using <code class="highlighter-rouge">col = "&lt;color name&gt;"</code>.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">,</span><span class="w">
     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Length (cm)"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Width (cm)"</span><span class="p">,</span><span class="w">
     </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-49-1.png" title="plot of chunk unnamed-chunk-49" alt="plot of chunk unnamed-chunk-49" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>Of course, we don’t want all of the points to be blue. The <code class="highlighter-rouge">col</code> argument can also take a list that is the same length of the <code class="highlighter-rouge">x</code> and <code class="highlighter-rouge">y</code> arguments that assigns individual color values to each point. Since we know the species order for the point, we can use logical indexing to assign colors to each species.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># iris$Species is a factor, which makes things easier in this case</span><span class="w">
</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [1] setosa     setosa     setosa     setosa     setosa     setosa    
  [7] setosa     setosa     setosa     setosa     setosa     setosa    
 [13] setosa     setosa     setosa     setosa     setosa     setosa    
 [19] setosa     setosa     setosa     setosa     setosa     setosa    
 [25] setosa     setosa     setosa     setosa     setosa     setosa    
 [31] setosa     setosa     setosa     setosa     setosa     setosa    
 [37] setosa     setosa     setosa     setosa     setosa     setosa    
 [43] setosa     setosa     setosa     setosa     setosa     setosa    
 [49] setosa     setosa     versicolor versicolor versicolor versicolor
 [55] versicolor versicolor versicolor versicolor versicolor versicolor
 [61] versicolor versicolor versicolor versicolor versicolor versicolor
 [67] versicolor versicolor versicolor versicolor versicolor versicolor
 [73] versicolor versicolor versicolor versicolor versicolor versicolor
 [79] versicolor versicolor versicolor versicolor versicolor versicolor
 [85] versicolor versicolor versicolor versicolor versicolor versicolor
 [91] versicolor versicolor versicolor versicolor versicolor versicolor
 [97] versicolor versicolor versicolor versicolor virginica  virginica 
[103] virginica  virginica  virginica  virginica  virginica  virginica 
[109] virginica  virginica  virginica  virginica  virginica  virginica 
[115] virginica  virginica  virginica  virginica  virginica  virginica 
[121] virginica  virginica  virginica  virginica  virginica  virginica 
[127] virginica  virginica  virginica  virginica  virginica  virginica 
[133] virginica  virginica  virginica  virginica  virginica  virginica 
[139] virginica  virginica  virginica  virginica  virginica  virginica 
[145] virginica  virginica  virginica  virginica  virginica  virginica 
Levels: setosa versicolor virginica
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">levels</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] "setosa"     "versicolor" "virginica" 
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Let's define a list of colors to use in the plot</span><span class="w">
</span><span class="n">col.list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">,</span><span class="w"> </span><span class="s2">"green"</span><span class="p">)</span><span class="w"> </span><span class="c1"># the color order will be assigned in order of factor levels</span><span class="w">
</span><span class="n">col.list</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] "red"   "blue"  "green"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Recall that when we enter a factor as an index, R sees the underlying nueric representation:</span><span class="w">
</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 [36] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 [71] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3
[106] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
[141] 3 3 3 3 3 3 3 3 3 3
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Taking advantage of this, we can direclty index our color list and set up a vector the length of iris$Species</span><span class="w">
</span><span class="c1"># with a unique color value for each species name</span><span class="w">
</span><span class="n">col.vector</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">col.list</span><span class="p">[</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">]</span><span class="w">
</span><span class="n">col.vector</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [1] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
  [9] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [17] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [25] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [33] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [41] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [49] "red"   "red"   "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [57] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [65] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [73] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [81] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [89] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [97] "blue"  "blue"  "blue"  "blue"  "green" "green" "green" "green"
[105] "green" "green" "green" "green" "green" "green" "green" "green"
[113] "green" "green" "green" "green" "green" "green" "green" "green"
[121] "green" "green" "green" "green" "green" "green" "green" "green"
[129] "green" "green" "green" "green" "green" "green" "green" "green"
[137] "green" "green" "green" "green" "green" "green" "green" "green"
[145] "green" "green" "green" "green" "green" "green"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># note that the lengths are indeed the same</span><span class="w">
</span><span class="nf">length</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">col.vector</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] TRUE
</code></pre></div></div>

<p> </p>

<p>Now that we have our color assignments stored in the <code class="highlighter-rouge">col.vector</code> variable, we can use that to color our plot by species.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">,</span><span class="w">
     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Length (cm)"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Width (cm)"</span><span class="p">,</span><span class="w">
     </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.vector</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-51-1.png" title="plot of chunk unnamed-chunk-51" alt="plot of chunk unnamed-chunk-51" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>As suspected, the lower left grouping is a single species. The other upper right grouping also breaks down nicely by species. But which is which? We can add a legend using the (you guessed it!) <code class="highlighter-rouge">legend()</code> function. First let’s look at the inputs:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">?</span><span class="n">legend</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>The <code class="highlighter-rouge">legend()</code> function is not very smart. It does not actually have access to any information about the plot, and requires that we give it all of information about what information to include. This can be annoying for basic plots, but it gives you the flexibility to customize the information in your charts to any degree that you like. At a minimum, we need to give it the following arguments:</p>
<ul>
  <li><code class="highlighter-rouge">x</code> tells R where to put the legend on the plot. You can give it simple direction like <code class="highlighter-rouge">"center"</code>, <code class="highlighter-rouge">left</code>, or <code class="highlighter-rouge">bottomright</code>.</li>
  <li><code class="highlighter-rouge">legend</code> tells R the list of labels for the legend, in this case we want the species names in factor level order (yes, the argument name is the same)</li>
  <li><code class="highlighter-rouge">col</code> tells R the colors to display. We want to give it the same color order that we used to generate the species-matched color list.</li>
  <li><code class="highlighter-rouge">pch</code> tells R the type of symbol to display. By default, the <code class="highlighter-rouge">plot()</code> function sets <code class="highlighter-rouge">pch = 1</code>, but this does not have a default value in <code class="highlighter-rouge">legend()</code> for some reason. For now we want <code class="highlighter-rouge">pch = 1</code> to match the <code class="highlighter-rouge">plot()</code> default.</li>
</ul>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">legend</span><span class="p">(</span><span class="s2">"bottomright"</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levels</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="n">col.list</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-53-1.png" title="plot of chunk unnamed-chunk-53" alt="plot of chunk unnamed-chunk-53" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>Now we can see that the setosa species has the small petal size.</p>

<p>What if the iris$Species were saved as a <code class="highlighter-rouge">character</code> instead of a <code class="highlighter-rouge">factor</code>? We can still accomplish the same outcome, it’s just a touch more complicated.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># First let's setup a new data frame with Species converted to a character vector</span><span class="w">
</span><span class="n">iris.char</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">iris</span><span class="w">
</span><span class="n">iris.char</span><span class="o">$</span><span class="n">Species</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">)</span><span class="w">

</span><span class="c1"># Now, since we don't have the underlying numeric structure of the factor, we need a </span><span class="w">
</span><span class="c1"># way to generate the same index list with a character vector. We can do this using</span><span class="w">
</span><span class="c1"># the match() function.</span><span class="w">
</span><span class="n">species.list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="n">iris.char</span><span class="o">$</span><span class="n">Species</span><span class="p">)</span><span class="w"> </span><span class="c1"># first grab the species list using unique()</span><span class="w">
</span><span class="n">species.list</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] "setosa"     "versicolor" "virginica" 
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># For each element in the first list, match() essentially asks R, where is this element</span><span class="w">
</span><span class="c1"># in the second list? It returns the numeric position, or index.</span><span class="w">
</span><span class="n">species.index</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">match</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">species.list</span><span class="p">)</span><span class="w">
</span><span class="n">species.index</span><span class="w"> 
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 [36] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 [71] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3
[106] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
[141] 3 3 3 3 3 3 3 3 3 3
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># We still need our color list...</span><span class="w">
</span><span class="n">col.list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">,</span><span class="w"> </span><span class="s2">"green"</span><span class="p">)</span><span class="w"> 

</span><span class="c1"># And we use the species.index in place of iris$Species to do the indexing and generate</span><span class="w">
</span><span class="c1"># our color list for each point on the plot</span><span class="w">
</span><span class="n">col.vector</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">col.list</span><span class="p">[</span><span class="n">species.index</span><span class="p">]</span><span class="w">
</span><span class="n">col.vector</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [1] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
  [9] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [17] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [25] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [33] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [41] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [49] "red"   "red"   "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [57] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [65] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [73] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [81] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [89] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [97] "blue"  "blue"  "blue"  "blue"  "green" "green" "green" "green"
[105] "green" "green" "green" "green" "green" "green" "green" "green"
[113] "green" "green" "green" "green" "green" "green" "green" "green"
[121] "green" "green" "green" "green" "green" "green" "green" "green"
[129] "green" "green" "green" "green" "green" "green" "green" "green"
[137] "green" "green" "green" "green" "green" "green" "green" "green"
[145] "green" "green" "green" "green" "green" "green"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Finally, we can generate our plot. Note that we now use "species.list" in place of </span><span class="w">
</span><span class="c1"># "levels(iris$Species)" for the legend</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">iris.char</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris.char</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">,</span><span class="w"> 
     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Length (cm)"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Width (cm)"</span><span class="p">,</span><span class="w">
     </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.vector</span><span class="p">)</span><span class="w">
</span><span class="n">legend</span><span class="p">(</span><span class="s2">"bottomright"</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">species.list</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="n">col.list</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-54-1.png" title="plot of chunk unnamed-chunk-54" alt="plot of chunk unnamed-chunk-54" width="612" style="display: block; margin: auto;" /></p>

<p> </p>
<h4 id="box-and-whisker-plots">Box and whisker plots</h4>

<p>We can now draw a scatter plot in R to look at the relationship between two variables. What if we want to compare a single data type across species? This is (still) most commonly done using bar charts with error bars. There is a movement in the biological sciences community to move away from bar charts and toward box and whisker plots. R is better equipped for the latter case any way, and that’s what we will work with in this course.</p>

<blockquote class="callout">
  <h2 id="why-use-box-and-whisker-charts-instead-of-bar-charts">Why use box and whisker charts instead of bar charts?</h2>

  <p>While bar charts are still more common and have their uses, box and whisker plots are
almost always better. A few problems with bar charts are that they:</p>
  <ul>
    <li>only show summary statistics (mean and variation)</li>
    <li>hide information on the shape of the data distribution</li>
    <li>can easily be used to misrepresent the size of differences between data</li>
    <li>do not have standard error bars (standard deviation and standard error are both common)</li>
  </ul>

  <p>Box and whisker plots provide a lot more detail about the data represented. A typical
box and whisker plot include:</p>
  <ul>
    <li>median (line in the middle of the box)</li>
    <li>quartiles (the size of the box)</li>
    <li>95 percentiles (whiskers)</li>
    <li>outliers (points beyond whiskers)</li>
    <li>all data points (less common, but a good idea)</li>
    <li>mean (also less common, but a good idea)</li>
  </ul>

</blockquote>

<p> </p>

<p>We can use the <code class="highlighter-rouge">boxplot()</code> function to generate box and whisker plots in R. To do so, we will usually use <code class="highlighter-rouge">formula</code> notation to enter the data. In this case, the first argument should be a formula indicating which data you want to plot and how your want it broken out, separated by the <code class="highlighter-rouge">~</code> symbol:</p>

<p>     &amp;nbsp<code class="highlighter-rouge">&lt;plot variable&gt; ~ &lt;separator variable&gt;</code></p>

<p>You can also provide the name of the data frame using the <code class="highlighter-rouge">data</code> argument, and then just use the column names directly in the formula. Let’s give it a try for Petal Length separated by Species in the iris dataset:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">boxplot</span><span class="p">(</span><span class="n">Petal.Length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-55-1.png" title="plot of chunk unnamed-chunk-55" alt="plot of chunk unnamed-chunk-55" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>It is a best practice to show all your data points (at least until you have hundreds or thousands) on box plots, which we can add to our plot using the <code class="highlighter-rouge">stripchart()</code> function. The basic format is similar to that for <code class="highlighter-rouge">boxplot()</code>. We need to add a couple of arguments to make it work. The first is <code class="highlighter-rouge">add = TRUE</code>. This tells R to add the points to the current plot, instead of generating a new plot (which is the default behavior). The Second is <code class="highlighter-rouge">vert = TRUE</code>, which tells R that we want the data plotted vertically (horizontal is the default). Let’s try it:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stripchart</span><span class="p">(</span><span class="n">Petal.Length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="n">add</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">vert</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-56-1.png" title="plot of chunk unnamed-chunk-56" alt="plot of chunk unnamed-chunk-56" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>Okay, the points are there, but the have some issues. Let’s add some information to improve the quality. Note that we need to rerun the boxplot command to regenerate the base plot before fixing the strip chart issues (otherwise they will just keep adding new points to the current chart and make a mess).</p>

<p>We will make the following changes:</p>

<p><code class="highlighter-rouge">boxplot()</code>:</p>
<ul>
  <li><code class="highlighter-rouge">outline = FALSE</code> prevents outlier points from being plotted (strip chart will be plotting all of the points anyway).</li>
  <li><code class="highlighter-rouge">ylab = "Petal Length (cm)"</code> cleans up our y-axis label.</li>
</ul>

<p><code class="highlighter-rouge">stripchart()</code>:</p>
<ul>
  <li><code class="highlighter-rouge">pch = 16</code> in <code class="highlighter-rouge">stripchart()</code> changes the point from an open square to a solid circle, which is easier to see against the box plot.</li>
  <li><code class="highlighter-rouge">method = "jitter"</code> in <code class="highlighter-rouge">stripchart()</code> offsets each point in the “x” direction by a small random amount so that you can see overlapping points.</li>
</ul>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">boxplot</span><span class="p">(</span><span class="n">Petal.Length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> 
        </span><span class="n">outline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Length (cm)"</span><span class="p">)</span><span class="w">
</span><span class="n">stripchart</span><span class="p">(</span><span class="n">Petal.Length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> 
           </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"jitter"</span><span class="p">,</span><span class="w">
           </span><span class="n">add</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">vert</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-57-1.png" title="plot of chunk unnamed-chunk-57" alt="plot of chunk unnamed-chunk-57" width="612" style="display: block; margin: auto;" /></p>

<p> </p>
<h4 id="multipanel-plots">Multipanel plots</h4>

<p>Finally, let’s look at how we can put multiple related panels in the same plot. This requires going beyond the <code class="highlighter-rouge">plot()</code> and <code class="highlighter-rouge">boxplot()</code> functions.</p>

<p>Take a look at the <code class="highlighter-rouge">?plot</code> documentation. Notice that there really aren’t that many input options, but that there is a “…” listed, which references the <code class="highlighter-rouge">par()</code> function. This will also introduce you to the <code class="highlighter-rouge">par()</code> function. Under the surface, there are probably hundreds of tweaks that you can make to plots through arguments.  R has a set of predefined graphical parameters that are all stored in the background. The <code class="highlighter-rouge">par()</code> function queries and sets these parameters. If you don’t give it any arguments, <code class="highlighter-rouge">par()</code> will return the current settings for all of these variables. We can see what they mean using <code class="highlighter-rouge">?par</code>.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">?</span><span class="n">par</span><span class="w">
</span></code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot.options</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">par</span><span class="p">()</span><span class="w"> </span><span class="c1"># this just assigns all of the current background plot options to a variable. Not a bad idea if you are going to be changing things</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">plot.options</span><span class="p">)</span><span class="w"> </span><span class="c1"># this is a list with a bunch of graphical related variables</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$xlog
[1] FALSE

$ylog
[1] FALSE

$adj
[1] 0.5

$ann
[1] TRUE

$ask
[1] FALSE

$bg
[1] "white"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">length</span><span class="p">(</span><span class="n">plot.options</span><span class="p">)</span><span class="w"> </span><span class="c1"># there are 72 variables that we can tweak in par() alone, and some have multiple parameters</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 72
</code></pre></div></div>

<p> </p>

<p>If we want to make a multipanel plot, say with box plots of Petal Length and Petal Width, and then the correlation between them, we can use <code class="highlighter-rouge">par()</code> before running plot to tell R how many rows and columns of figure panels that we want to create. We use this by passing the argument <code class="highlighter-rouge">mfrow = c(&lt;# of rows&gt;, &lt;# of columns&gt;)</code> to <code class="highlighter-rouge">par()</code>. This changes the value of the background graphical parameters. Note that we later have to change this back if we want to make a normal plot.</p>

<p>Once we set <code class="highlighter-rouge">mfrow</code> we can then run our above plot commands in the order we want them displayed. Let’s give it a try:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># get the current graphical parameters</span><span class="w">
</span><span class="n">old.plot.options</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">par</span><span class="p">()</span><span class="w"> </span><span class="c1"># it never hurts to save a copy of the old parameters, so we can reset them if we break something</span><span class="w">

</span><span class="c1"># setup a plot with 3 figure panels in a row using the mfrow argument</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">))</span><span class="w"> </span><span class="c1"># 1 row, 3 columns</span><span class="w">

</span><span class="c1"># Panel 1: Box plot with jittered stripchart points for Petal Length</span><span class="w">
</span><span class="n">boxplot</span><span class="p">(</span><span class="n">Petal.Length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> 
        </span><span class="n">outline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Length (cm)"</span><span class="p">)</span><span class="w">
</span><span class="n">stripchart</span><span class="p">(</span><span class="n">Petal.Length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> 
           </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"jitter"</span><span class="p">,</span><span class="w">
           </span><span class="n">add</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">vert</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">

</span><span class="c1"># Panel 2: Box plot with jittered stripchart points for Petal Width</span><span class="w">
</span><span class="n">boxplot</span><span class="p">(</span><span class="n">Petal.Width</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> 
        </span><span class="n">outline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Width (cm)"</span><span class="p">)</span><span class="w">
</span><span class="n">stripchart</span><span class="p">(</span><span class="n">Petal.Width</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> 
           </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"jitter"</span><span class="p">,</span><span class="w">
           </span><span class="n">add</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">vert</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">

</span><span class="c1"># Panel 3: Scatter plot comparing Petal Length to Petal Width</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">iris.char</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris.char</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">,</span><span class="w"> 
     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Length (cm)"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Width (cm)"</span><span class="p">,</span><span class="w">
     </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.vector</span><span class="p">)</span><span class="w">
</span><span class="n">legend</span><span class="p">(</span><span class="s2">"bottomright"</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">species.list</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="n">col.list</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-60-1.png" title="plot of chunk unnamed-chunk-60" alt="plot of chunk unnamed-chunk-60" width="612" style="display: block; margin: auto;" /></p>

<p> </p>
<h4 id="box-plots-with-multiple-independent-variables--getting-to-publication-quality">Box plots with multiple independent variables – getting to publication quality</h4>

<p>Box plots begin to tax the default behavior of R when it comes to things like axis labeling. Let’s use the gender-corrected version of our aneurism data (“sample-gendercorrected.csv”) to take a look at plotting when multiple independent variables are in play. First, load the data:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data.an</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s2">"data/sample-gendercorrected.csv"</span><span class="p">)</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">data.an</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      ID Gender      Group BloodPressure  Age Aneurisms_q1 Aneurisms_q2
1 Sub001      M    Control           132 16.0          114          140
2 Sub002      M Treatment2           139 17.2          148          209
3 Sub003      M Treatment2           130 19.5          196          251
4 Sub004      F Treatment1           105 15.7          199          140
5 Sub005      M Treatment1           125 19.9          188          120
6 Sub006      M Treatment2           112 14.3          260          266
  Aneurisms_q3 Aneurisms_q4
1          202          237
2          248          248
3          122          177
4          233          220
5          222          228
6          320          294
</code></pre></div></div>

<p> </p>

<p>What if we want to plot quarter 1 aneurisms broken down by both gender and treatment group. The <code class="highlighter-rouge">formula</code> notation used in <code class="highlighter-rouge">boxplot()</code> makes this pretty straightforward:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># use the '+' to indicate multiple grouping variables</span><span class="w">
</span><span class="n">boxplot</span><span class="p">(</span><span class="n">Aneurisms_q1</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Group</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Gender</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data.an</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-62-1.png" title="plot of chunk unnamed-chunk-62" alt="plot of chunk unnamed-chunk-62" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>We have the data in the right place, but the group labels are all horizontal, so they can’t be displayed. There is also no clear visual way to distinguish how the treatment groups and gender groups are separated.</p>

<p>We can take several steps to improve the look in chart:</p>
<ul>
  <li>Use the <code class="highlighter-rouge">at</code> argument to change the box spacing. By default, boxes are drawn centered over the integers 1, 2, 3, …, n, where n is the number of boxes. By redefining these locations and skipping numbers, you can add spaces between groups.</li>
  <li>Use box colors to indicate treatment groups (<code class="highlighter-rouge">col</code> argument plus the <code class="highlighter-rouge">legend()</code> function) and x-axis labels to indicate gender. There are other ways to do this, but this is one of the more visually appealing.</li>
  <li>Tick marks are often not useful in box plots. To turn them off, we will use the <code class="highlighter-rouge">xaxt</code> to run off all x-axis feature, and then use the separate function <code class="highlighter-rouge">axis()</code> to add the ones we want back (sans tick marks).</li>
  <li>Make the y-axis label look better with <code class="highlighter-rouge">ylab</code>.</li>
  <li>Add all points with <code class="highlighter-rouge">stripchart()</code>.</li>
</ul>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># draw the box plot first</span><span class="w">
</span><span class="n">boxplot</span><span class="p">(</span><span class="n">Aneurisms_q1</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Group</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Gender</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data.an</span><span class="p">,</span><span class="w"> 
        </span><span class="n">xaxt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"n"</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="c1"># turn off all x-axis labeling (so we can redraw it below)</span><span class="w">
        </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"# Aneurisms (Q1)"</span><span class="p">,</span><span class="w"> </span><span class="c1"># y axis label</span><span class="w">
        </span><span class="n">at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="m">6</span><span class="p">,</span><span class="m">7</span><span class="p">),</span><span class="w"> </span><span class="c1"># leave a space between gender groups</span><span class="w">
        </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"grey"</span><span class="p">,</span><span class="s2">"blue"</span><span class="p">,</span><span class="s2">"red"</span><span class="p">))</span><span class="w"> </span><span class="c1"># color boxes by treatment for legend</span><span class="w">
        
</span><span class="c1"># now add the points with stripchart with the same parameters as box</span><span class="w">
</span><span class="n">stripchart</span><span class="p">(</span><span class="n">Aneurisms_q1</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Group</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Gender</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data.an</span><span class="p">,</span><span class="w"> 
        </span><span class="n">add</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">vert</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="c1"># add the points to the current boxplot vertically</span><span class="w">
        </span><span class="n">at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="m">6</span><span class="p">,</span><span class="m">7</span><span class="p">),</span><span class="w"> </span><span class="c1"># leave a space between gender groups</span><span class="w">
        </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"black"</span><span class="p">),</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="c1"># color and symbol for points</span><span class="w">
        </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"jitter"</span><span class="p">)</span><span class="w"> </span><span class="c1"># jitter the points</span><span class="w">

</span><span class="n">axis</span><span class="p">(</span><span class="n">side</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="c1"># add axis labels to the x-axis</span><span class="w">
     </span><span class="n">at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="w"> </span><span class="c1"># place the labels under the middle boxes of each group</span><span class="w">
     </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"female"</span><span class="p">,</span><span class="s2">"male"</span><span class="p">),</span><span class="w"> </span><span class="c1"># gender labels</span><span class="w">
     </span><span class="n">tick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> </span><span class="c1"># do not add tick marks</span><span class="w">

</span><span class="c1"># now add a legend to indicate</span><span class="w">
</span><span class="n">legend</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"top"</span><span class="p">,</span><span class="w"> </span><span class="n">inset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-0.13</span><span class="p">,</span><span class="w"> </span><span class="c1"># place the legend on top, but nudge it up a bit</span><span class="w">
       </span><span class="n">xpd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">,</span><span class="w"> </span><span class="c1"># allow the legend to be drawn outside the plot area</span><span class="w">
       </span><span class="n">bty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"n"</span><span class="p">,</span><span class="w"> </span><span class="c1"># don't draw a box around the legend</span><span class="w">
       </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="c1"># use 3 columns (one row, since we have 3 groups)</span><span class="w">
       </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"grey"</span><span class="p">,</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">,</span><span class="w"> </span><span class="s2">"red"</span><span class="p">),</span><span class="w"> </span><span class="c1"># fill boxes with the same colors as boxplot</span><span class="w">
       </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levels</span><span class="p">(</span><span class="n">data.an</span><span class="o">$</span><span class="n">Group</span><span class="p">))</span><span class="w"> </span><span class="c1"># labels by treatement group</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-63-1.png" title="plot of chunk unnamed-chunk-63" alt="plot of chunk unnamed-chunk-63" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>This ends up with a fairly complex script for a single chart, but when you start to directly generate publication quality graphics in R, this is what it tends to look like. Once you go through the process of setting up a plot that you like once, you can always copy that whole chunk of code into the next project (or write a custom plot function with your own defaults!). Over time, you build up a sort of personal “library” of code chunks and can make really nice graphics in relatively little time.</p>

<p> </p>
<h4 id="other-resources-for-plotting">Other resources for plotting</h4>

<p>This lesson gives you access to the two most common chart types used in biology: scatterplots and box plots (which can usually be used in place of bar charts). This is just the tip of a very large iceberg. R has the capability of producing any visualization you can imagine, and there are full workshops and courses dedicated just to generating graphics in R. The potential applications are as varied as your projects, and the best thing you can do is to sit down and start using the functions with Google search close at hand.</p>

<p>We don’t have the time to do everything, but we will be using both of these chart types throughout the course, and introducing several others (histograms, density charts, line graphs, Kaplan-Meier charts, etc).  For now, a few resources that will help you along the way:</p>
<ul>
  <li>A cheat sheet for the graphics tools that come with R (aka “R base graphics”) can be downloaded <a href="../fig/BaseGraphicsCheatsheet.pdf">here</a>.</li>
  <li>The <code class="highlighter-rouge">lattice</code> package makes some improvements to R base graphics and functions. The defaults are better for example.</li>
  <li>The other commonly graphics package is called <code class="highlighter-rouge">ggplot2</code>. I have tended toward base graphics, because you can literally do anything with them, but <code class="highlighter-rouge">ggplot2</code> is easier in some ways, once you get the syntax down (which is very different). Cheat sheet is <a href="../fig/ggplot2-cheatsheet.pdf">here</a>.</li>
  <li>Google is your friend. There are probably thousands of tutorials, forum Q&amp;As, cheat sheets, etc. to answer your project specific questions. For a taste, go to Google and search “publication quality graphics in R”</li>
</ul>

<hr />
<h3 id="exercises-1">Exercises</h3>

<blockquote class="challenge">
  <h2 id="on-the-road--does-what-you-drive-or-where-you-drive-it-matter">On the road – does what you drive or where you drive it matter?</h2>

  <p>Read in our sample data on car speeds (car-speeds.csv) and visualize differences in car 
speed by both state and color.</p>

  <blockquote class="solution">
    <h2 id="solution-6">Solution</h2>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># set data and results directories</span><span class="w">
</span><span class="n">data.dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"data"</span><span class="w">
</span><span class="n">results.dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"results"</span><span class="w">

</span><span class="c1"># load data</span><span class="w">
</span><span class="n">carSpeeds</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="n">data.dir</span><span class="p">,</span><span class="s2">"/car-speeds.csv"</span><span class="p">))</span><span class="w">

</span><span class="c1"># setup two panel figure</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span><span class="w">

</span><span class="c1"># use a box plot with jittered strip chart overlay to plot car speed as a function</span><span class="w">
</span><span class="c1"># of state</span><span class="w">
</span><span class="n">boxplot</span><span class="p">(</span><span class="n">Speed</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">State</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">carSpeeds</span><span class="p">,</span><span class="w"> 
        </span><span class="n">outline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Car Speed (mph)"</span><span class="p">)</span><span class="w">
</span><span class="n">stripchart</span><span class="p">(</span><span class="n">Speed</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">State</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">carSpeeds</span><span class="p">,</span><span class="w"> 
        </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"jitter"</span><span class="p">,</span><span class="w">
        </span><span class="n">add</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">vert</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">

</span><span class="c1"># use a box plot with jittered strip chart overlay to plot car speed as a function</span><span class="w">
</span><span class="c1"># of car color</span><span class="w">
</span><span class="n">boxplot</span><span class="p">(</span><span class="n">Speed</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Color</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">carSpeeds</span><span class="p">,</span><span class="w"> 
        </span><span class="n">outline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Car Speed (mph)"</span><span class="p">)</span><span class="w">
</span><span class="n">stripchart</span><span class="p">(</span><span class="n">Speed</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Color</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">carSpeeds</span><span class="p">,</span><span class="w"> 
        </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"jitter"</span><span class="p">,</span><span class="w">
            </span><span class="n">add</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">vert</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-64-1.png" title="plot of chunk unnamed-chunk-64" alt="plot of chunk unnamed-chunk-64" width="612" style="display: block; margin: auto;" /></p>
  </blockquote>
</blockquote>

<blockquote class="challenge">
  <h2 id="blood-pressure-as-a-risk-factor-for-aneurism">Blood pressure as a risk factor for aneurism</h2>

  <p>Does blood pressure appear to have an impact on aneurism risk?</p>

  <p>Examine these questions using the file that we created in the “Correcting Case in Gender”
exercise earlier (sample-gendercorrected.csv). What, other than blood pressure, may explain
any apparent correlation (or lack there of?).</p>

  <p>Save your results to a PDF file.</p>

  <blockquote class="solution">
    <h2 id="solution-7">Solution</h2>

    <p>I left this intentionally a bit vague, which means that there are several solutions. But 
that is often the nature of real data in real research.</p>

    <p>Since we are trying to gt a general idea here, I am first going to calculate the average
quarterly aneurisms and the total yearly aneurisms (you could also look at each quarter
independently).</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># set data and results directories</span><span class="w">
</span><span class="n">data.dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"data"</span><span class="w">
</span><span class="n">results.dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"results"</span><span class="w">

</span><span class="c1"># load data</span><span class="w">
</span><span class="n">data.an</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="n">data.dir</span><span class="p">,</span><span class="s2">"/sample-gendercorrected.csv"</span><span class="p">))</span><span class="w">

</span><span class="c1"># define new columns for average quarterly and total annual aneurisms and calculate</span><span class="w">
</span><span class="n">data.an</span><span class="o">$</span><span class="n">Aneurisms_qmean</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rowMeans</span><span class="p">(</span><span class="n">data.an</span><span class="p">[,</span><span class="m">6</span><span class="o">:</span><span class="m">9</span><span class="p">])</span><span class="w">
</span><span class="n">data.an</span><span class="o">$</span><span class="n">Aneurisms_total</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rowSums</span><span class="p">(</span><span class="n">data.an</span><span class="p">[,</span><span class="m">6</span><span class="o">:</span><span class="m">9</span><span class="p">])</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">data.an</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      ID Gender      Group BloodPressure  Age Aneurisms_q1 Aneurisms_q2
1 Sub001      M    Control           132 16.0          114          140
2 Sub002      M Treatment2           139 17.2          148          209
3 Sub003      M Treatment2           130 19.5          196          251
4 Sub004      F Treatment1           105 15.7          199          140
5 Sub005      M Treatment1           125 19.9          188          120
6 Sub006      M Treatment2           112 14.3          260          266
  Aneurisms_q3 Aneurisms_q4 Aneurisms_qmean Aneurisms_total
1          202          237          173.25             693
2          248          248          213.25             853
3          122          177          186.50             746
4          233          220          198.00             792
5          222          228          189.50             758
6          320          294          285.00            1140
</code></pre></div>    </div>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># initiate a PDF file and setup two panel figure</span><span class="w">
</span><span class="n">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">paste0</span><span class="p">(</span><span class="n">results.dir</span><span class="p">,</span><span class="w"> </span><span class="s2">"/aneurisms-bloodpressure-chart.pdf"</span><span class="p">),</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span><span class="w">

</span><span class="c1"># use a scatter plot to look for apparent correlation between blood pressure and </span><span class="w">
</span><span class="c1"># both summary measures of aneurism (in separate panels)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">data.an</span><span class="o">$</span><span class="n">BloodPressure</span><span class="p">,</span><span class="w"> </span><span class="n">data.an</span><span class="o">$</span><span class="n">Aneurisms_qmean</span><span class="p">,</span><span class="w"> 
     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Blood Pressure (mmHg)"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Mean Aneurisms per Quarter"</span><span class="p">)</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">data.an</span><span class="o">$</span><span class="n">BloodPressure</span><span class="p">,</span><span class="w"> </span><span class="n">data.an</span><span class="o">$</span><span class="n">Aneurisms_total</span><span class="p">,</span><span class="w"> 
     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Blood Pressure (mmHg)"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Aneurisms per Year"</span><span class="p">)</span><span class="w">

</span><span class="c1"># turn off PDF device</span><span class="w">
</span><span class="n">dev.off</span><span class="p">()</span><span class="w">
</span></code></pre></div>    </div>

    <div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>png 
  2 
</code></pre></div>    </div>

    <p>There is no apparent correlation, but there are a lot of potential confounders within the
data set that we are not examining in this exercise so far (treatment, gender, age)</p>
  </blockquote>
</blockquote>

<blockquote class="challenge">
  <h2 id="correlations-between-petal-and-sepal-in-iris-data">Correlations between petal and sepal in iris data</h2>

  <p>We looked a correlation between petal length and width. What about correlations between petal
and sepal? Generate scatter plots to look at length and width correlations, broken down by species.</p>

  <p>Save your results to a PDF.</p>

  <blockquote class="solution">
    <h2 id="solution-8">Solution</h2>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># set data and results directories</span><span class="w">
</span><span class="n">data.dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"data"</span><span class="w">
</span><span class="n">results.dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"results"</span><span class="w">

</span><span class="c1"># initiate a PDF file and setup two panel figure</span><span class="w">
</span><span class="n">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">paste0</span><span class="p">(</span><span class="n">results.dir</span><span class="p">,</span><span class="w"> </span><span class="s2">"/iris-petal-sepal-correlations.pdf"</span><span class="p">),</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span><span class="w">

</span><span class="c1"># Define colors</span><span class="w">
</span><span class="n">col.list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">,</span><span class="w"> </span><span class="s2">"green"</span><span class="p">)</span><span class="w"> 

</span><span class="c1"># And we use the species.index in place of iris$Species to do the indexing and generate</span><span class="w">
</span><span class="c1"># our color list for each point on the plot</span><span class="w">
</span><span class="n">col.vector</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">col.list</span><span class="p">[</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">]</span><span class="w">

</span><span class="c1"># Plot petal length x sepal length, then petal width x sepal width in subsequent panels</span><span class="w">
</span><span class="c1"># we only need one legend, which after an initial look at the data, fits best in the top</span><span class="w">
</span><span class="c1"># left of the first panel</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="p">,</span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Length (cm)"</span><span class="p">,</span><span class="w"> 
      </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Sepal Length (cm)"</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.vector</span><span class="p">)</span><span class="w">
</span><span class="n">legend</span><span class="p">(</span><span class="s2">"topleft"</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levels</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="n">col.list</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Width</span><span class="p">,</span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Width (cm)"</span><span class="p">,</span><span class="w"> 
      </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Sepal Width (cm)"</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.vector</span><span class="p">)</span><span class="w">

</span><span class="c1"># turn off the PDF device</span><span class="w">
</span><span class="n">dev.off</span><span class="p">()</span><span class="w">
</span></code></pre></div>    </div>

    <div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>png 
  2 
</code></pre></div>    </div>
  </blockquote>
</blockquote>

<blockquote class="challenge">
  <h2 id="exploring-plot-options">Exploring plot options</h2>

  <p>R has hundreds of ways to change the way plots are displayed. The only way to 
really learn how to manipulate charts is to start playing with the options to
see what they do. Below are a range of options that I have used at one point
or another.</p>

  <p>Try starting with one of the plots with today’s lesson, change one
or more of the following parameters, then rerun the plot script to see what
changed. A good way to do this is to plot two charts with a single argument change
to the RStudio plot panel. The arrows at the top left of the panel let you look
through previous charts and see what changed. Alternatively, write the two charts
to subsequent pages of a PDF file for comparison.</p>

  <p><strong>Arguments to the <code class="highlighter-rouge">plot()</code> function</strong>
<em>Remember that default values can be found in <code class="highlighter-rouge">?plot</code> or by running <code class="highlighter-rouge">par()</code> with no arguments, and argument descriptions can be accessed in <code class="highlighter-rouge">?par</code>.</em></p>
  <ul>
    <li><em>bty</em></li>
    <li><em>border</em></li>
    <li><em>col</em></li>
    <li><em>lty</em></li>
    <li><em>lwd</em></li>
    <li><em>main</em></li>
    <li><em>sub</em></li>
    <li><em>type</em></li>
    <li><em>xlab</em>, <em>ylab</em></li>
    <li><em>xlim</em>, <em>ylim</em></li>
    <li><em>xaxs</em>, <em>yaxs</em></li>
    <li><em>xaxt</em>, <em>yaxt</em></li>
    <li><em>xlog</em>, <em>ylog</em></li>
    <li><em>xpd</em></li>
  </ul>

  <p><strong>Arguments to the <code class="highlighter-rouge">par()</code> function</strong>
*Note that these are typically passed to <code class="highlighter-rouge">par()</code> prior to running running a plot
function. Run <code class="highlighter-rouge">par()</code> for defaults and <code class="highlighter-rouge">?par</code> for argument descriptions.</p>
  <ul>
    <li><em>cex</em></li>
    <li><em>mar</em></li>
    <li><em>mfrow</em></li>
    <li><em>oma</em></li>
    <li><em>tcl</em></li>
  </ul>

  <p><em>You can set most of the arguments listed above in <code class="highlighter-rouge">plot()</code> using the <code class="highlighter-rouge">par()</code>
function as well, and it will set the default for future charts.</em></p>

  <p><strong>Functions that add elements to existing plots</strong>
<em>For this set, first generate a plot (e.g. with <code class="highlighter-rouge">plot()</code> or <code class="highlighter-rouge">boxplot()</code>)
and then call the following functions. Use <code class="highlighter-rouge">?</code> to see what arguments are
required for each</em></p>
  <ul>
    <li><code class="highlighter-rouge">abline()</code></li>
    <li><code class="highlighter-rouge">axis()</code></li>
    <li><code class="highlighter-rouge">box()</code></li>
    <li><code class="highlighter-rouge">legend()</code></li>
    <li><code class="highlighter-rouge">lines()</code></li>
    <li><code class="highlighter-rouge">mtext()</code></li>
    <li><code class="highlighter-rouge">points()</code></li>
    <li><code class="highlighter-rouge">text()</code></li>
    <li><code class="highlighter-rouge">title()</code></li>
  </ul>
</blockquote>



<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>Import data from a .csv or .txt file using the <code class="highlighter-rouge">read.table(...)</code>, <code class="highlighter-rouge">read.csv(...)</code>, and <code class="highlighter-rouge">read.delim(...)</code> functions.</p>
</li>
    
    <li><p>Understand some of the key arguments available for importing the data properly, including <code class="highlighter-rouge">header</code>, and <code class="highlighter-rouge">stringsAsFactors</code>.</p>
</li>
    
    <li><p>Write data to a new .csv file using the <code class="highlighter-rouge">write.table(...)</code> and <code class="highlighter-rouge">write.csv(...)</code> functions.</p>
</li>
    
    <li><p>Understand some of the key arguments available for exporting the data properly, such as <code class="highlighter-rouge">row.names</code>, <code class="highlighter-rouge">col.names</code>, and <code class="highlighter-rouge">quote</code>.</p>
</li>
    
    <li><p>Use <code class="highlighter-rouge">apply</code> to calculate statistics across the rows or columns of a data frame.</p>
</li>
    
    <li><p>Use <code class="highlighter-rouge">plot</code> to create simple visualizations.</p>
</li>
    
    <li><p>Display simple graphs.</p>
</li>
    
    <li><p>Save a plot in a pdf file using <code class="highlighter-rouge">pdf(...)</code> and stop writing to the pdf file with <code class="highlighter-rouge">dev.off()</code>.</p>
</li>
    
  </ul>
</blockquote>

</article>
















<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../02-introduction-to-R-basics/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../04-introduction-to-R-decisions-and-loops/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


      
      






<footer>
  <!--<div class="row">
    <div class="col-md-6 copyright" align="left">
	
    </div>
    <div class="col-md-6 help-links" align="right">
	
	
	<a href="/edit//_episodes_rmd/03-introduction-to-R-data-plotting.Rmd">Edit on GitHub</a>
	
	
	/
	<a href="/blob//CONTRIBUTING.md">Contributing</a>
	/
	<a href="/">Source</a>
	/
	<a href="/blob//CITATION">Cite</a>
	/
	<a href="mailto:sutphin@gmail.com">Contact</a>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12" align="center">
      Using <a href="https://github.com/carpentries/styles/">The Carpentries style</a>
      version <a href="https://github.com/carpentries/styles/releases/tag/v9.5.3">9.5.3</a>.
    </div>
  </div>-->
</footer>

      
    </div>
    
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
