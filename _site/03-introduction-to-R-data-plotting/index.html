















<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2019-08-26 00:29:27 -0700">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/syntax.css" />

    



    <!-- Favicons for everyone -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../assets/favicons/mcb585/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/favicons/mcb585/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/favicons/mcb585/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/favicons/mcb585/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../assets/favicons/mcb585/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../assets/favicons/mcb585/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../assets/favicons/mcb585/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../assets/favicons/mcb585/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content=" - MCB 585: Multidisciplinary/Quantitative Approaches to Solving Biological Problems"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="../assets/favicons/mcb585/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="../assets/favicons/mcb585/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="../assets/favicons/mcb585/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="../assets/favicons/mcb585/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="../assets/favicons/mcb585/mstile-310x310.png" />


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
    <title>MCB 585: Multidisciplinary/Quantitative Approaches to Solving Biological Problems: Introduction to R -- Reading, Writing, and Plotting Data</title>
  </head>
  <body>

    



    <div class="container">
      






<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      
      <a href="https://georgesutphin.github.io/MCB585/" class="pull-left">
        <img class="navbar-logo" src="../assets/img/mcb585-logo.svg" alt="MCB585 logo" />
      </a>
      

      
      <a class="navbar-brand" href="../">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>

        
	
        <li><a href="../setup.html">Setup</a></li>

        
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../01-R-RStudio-setup/index.html">Getting started with R and RStudio</a></li>
            
            <li><a href="../02-introduction-to-R-basics/index.html">Introduction to R -- Best Practices, Data Types, and Data Structures</a></li>
            
            <li><a href="../03-introduction-to-R-data-plotting/index.html">Introduction to R -- Reading, Writing, and Plotting Data</a></li>
            
	    <li role="separator" class="divider"></li>
            <li><a href="../aio.html">All in one page (Beta)</a></li>
          </ul>
        </li>
	

	
	<!--
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../reference.html">Reference</a></li>
            
            <li><a href="../about/">About</a></li>
            
            <li><a href="../discuss/">Discussion</a></li>
            
            <li><a href="../figures/">Figures</a></li>
            
            <li><a href="../guide/">Instructor Notes</a></li>
            
          </ul>
        </li>
	-->

	
        <li><a href="../LICENSE.html">About</a></li>
	<!--
	
	<li><a href="/edit//_episodes_rmd/03-introduction-to-R-data-plotting.Rmd">Improve this page <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></li>
	
	-->
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>

















<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../02-introduction-to-R-basics/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
    <h3 class="maintitle"><a href="../">MCB 585: Multidisciplinary/Quantitative Approaches to Solving Biological Problems</a></h3>
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../"><span class="glyphicon glyphicon-menu-up" aria-hidden="true"></span><span class="sr-only">lesson home</span></a>
      
    </h3>
  </div>
</div>

<article>
<div class="row">
  <div class="col-md-1">
  </div>
  <div class="col-md-10">
    <h1 class="maintitle">Introduction to R -- Reading, Writing, and Plotting Data</h1>
  </div>
  <div class="col-md-1">
  </div>
</div>


<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Class Date:</strong> 9/3/2019
      <br/>
      <strong>Teaching:</strong> 80 min
      <br/>
      <strong>Exercises:</strong> 25 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>How do I read data from a .csv or .txt file into R?</p>
</li>
	
	<li><p>How do I write data to a .csv or .txt file?</p>
</li>
	
	<li><p>How do I calculate simple statistics from my data?</p>
</li>
	
	<li><p>How can I plot my data?</p>
</li>
	
	<li><p>How do I save my plots to a PDF file?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Import data from a .csv or .txt file using the <code class="highlighter-rouge">read.table(...)</code>, <code class="highlighter-rouge">read.csv(...)</code>, and <code class="highlighter-rouge">read.delim(...)</code> functions.</p>
</li>
	
	<li><p>Use <code class="highlighter-rouge">mean</code>, <code class="highlighter-rouge">max</code>, <code class="highlighter-rouge">min</code>, and <code class="highlighter-rouge">sd</code> to calculate simple statistics.</p>
</li>
	
	<li><p>Write data to a new .csv or .txt file using the <code class="highlighter-rouge">write.table(...)</code> and <code class="highlighter-rouge">write.csv(...)</code> functions.</p>
</li>
	
	<li><p>Display simple graphs.</p>
</li>
	
	<li><p>Save plot(s) to a PDF file.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h3 id="reading-data-from-a-tabulated-file-csv-txt">Reading data from a tabulated file (.csv, .txt)</h3>

<p>In the majority of cases, your data will be stored in some type of external file. The most common way that scientists store data is in Excel spreadsheets. While there are R packages designed to access data from Excel spreadsheets (e.g., gdata, RODBC, XLConnect, xlsx, RExcel), these packages are often difficult and non-intuitive to use. When you start dealing with larger datasets, accessing data from Excel files in R also gets slow. users often find it easier to save their spreadsheets in one or more <a href="../reference.html#comma-separated-values-csv">comma-separated values</a> (CSV or .csv) or text (TXT or .txt) files and then use R’s built in functionality to read and manipulate the data. Both file types are more primitive forms of table/spreadsheet in which data is stored as text with distinct data elements separated by a <em>delimiting character</em> (a comma <code class="highlighter-rouge">,</code> for .csv files and usually a tab <code class="highlighter-rouge">\t</code> for .txt files).</p>

<p>Thankfully, Excel is capable of opening, editing, and saving both .csv and .txt files, so we can go back and forth between R and Excel when we find it convenient.</p>

<p>In this short lesson, we’ll learn how to read external data from a .csv or .txt file, and write data modified or generatated in R to a new .csv or .txt file. We will also explore the <a href="../reference.html#argument">arguments</a> that allow you read and write the data correctly for your needs.</p>

<p> </p>
<h4 id="loading-external-data-into-a-data-frame">Loading external data into a data frame</h4>

<p>Let’s start by loading some sample data and take a look at the first few rows of the contents using the <code class="highlighter-rouge">head()</code>:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/sample.csv'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>Open up the same file using a basic text editor (e.g. <em>Notepad</em> in Windows; <em>TextEdit</em> in MacOS). You should see something like this:</p>

<blockquote class="callout">
  <p>“ID”,”Gender”,”Group”,”BloodPressure”,”Age”,”Aneurisms_q1”,”Aneurisms_q2”,”Aneurisms_q3”,”Aneurisms_q4” 
“Sub001”,”m”,”Control”,132,16,114,140,202,237
“Sub002”,”m”,”Treatment2”,139,17.2,148,209,248,248
“Sub003”,”m”,”Treatment2”,130,19.5,196,251,122,177
“Sub004”,”f”,”Treatment1”,105,15.7,199,140,233,220
“Sub005”,”m”,”Treatment1”,125,19.9,188,120,222,228
“Sub006”,”M”,”Treatment2”,112,14.3,260,266,320,294</p>
</blockquote>

<p> </p>

<p>A couple of things to notice:</p>
<ul>
  <li>The frist line contains column headers.</li>
  <li>The <code class="highlighter-rouge">,</code> delimiters tell the <code class="highlighter-rouge">read.csv(...)</code> function where the breaks in the data are located; that is, which data to put in which column of the output data frame.</li>
  <li>Each new line is also a delimiter that tells <code class="highlighter-rouge">read.csv(...)</code> which data to put in which row in the output data frame</li>
  <li>In this case, all strings are contained withing quotation marks <code class="highlighter-rouge">""</code>. This is an optional way to tell the program where character strings start and stop.</li>
</ul>

<p>On the topic of using quotation marks, open <code class="highlighter-rouge">sample-noquotes.csv</code> in your text editor to see the quote-free option:</p>

<blockquote class="callout">
  <p>ID,Gender,Group,BloodPressure,Age,Aneurisms_q1,Aneurisms_q2,Aneurisms_q3,Aneurisms_q4 
Sub001,m,Control,132,16,114,140,202,237
Sub002,m,Treatment2,139,17.2,148,209,248,248
Sub003,m,Treatment2,130,19.5,196,251,122,177
Sub004,f,Treatment1,105,15.7,199,140,233,220
Sub005,m,Treatment1,125,19.9,188,120,222,228
Sub006,M,Treatment2,112,14.3,260,266,320,294</p>
</blockquote>

<p> </p>

<p>And note that the default <code class="highlighter-rouge">read.csv(...)</code> treats this file identically:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dat2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/sample-noquotes.csv'</span><span class="p">)</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">dat2</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      ID Gender      Group BloodPressure  Age Aneurisms_q1 Aneurisms_q2
1 Sub001      m    Control           132 16.0          114          140
2 Sub002      m Treatment2           139 17.2          148          209
3 Sub003      m Treatment2           130 19.5          196          251
4 Sub004      f Treatment1           105 15.7          199          140
5 Sub005      m Treatment1           125 19.9          188          120
6 Sub006      M Treatment2           112 14.3          260          266
  Aneurisms_q3 Aneurisms_q4
1          202          237
2          248          248
3          122          177
4          233          220
5          222          228
6          320          294
</code></pre></div></div>

<p> </p>

<p>Whether to use quotes in your data files is up to you. The default behavior of <code class="highlighter-rouge">read.csv(...)</code> is smart enough to figure this out on it’s own. However, the <code class="highlighter-rouge">read.csv(...)</code> has an argument called <code class="highlighter-rouge">quote</code> that dictates how to interpret quotation marks.</p>

<blockquote class="challenge">
  <h2 id="mis-loading-quoted-data">Mis-loading quoted data</h2>

  <p>What if we force <code class="highlighter-rouge">read.csv("")</code> to ignore the quotes when they are present?
Before you run any code, think about what will happen to the data in quotes
if we tell R that there are no “quote” characters.</p>

  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dat3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/sample.csv'</span><span class="p">,</span><span class="w"> </span><span class="n">quote</span><span class="o">=</span><span class="s2">""</span><span class="p">)</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">dat3</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>

  <blockquote class="solution">
    <h2 id="solution">Solution</h2>

    <p>The quotes are now included as part of the character arguments. It also messed up the header formating, apending
an “X” to the beginning and surrounding text with “.”ss.</p>
  </blockquote>
</blockquote>

<p> </p>

<p>What happens if we don’t assign the output of <code class="highlighter-rouge">read.csv(...)</code> to a variable?</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/sample.csv'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>As with any other function call, if the output is not explicitly assigned, it will be dumped into the console window.</p>

<p> </p>
<h4 id="changing-delimiters">Changing Delimiters</h4>

<p>The default delimiter of the <code class="highlighter-rouge">read.csv()</code> function is a comma <code class="highlighter-rouge">,</code>, but you can
use esentially any set of characters as a delimiter. <code class="highlighter-rouge">read.csv(...)</code> is actually a special case of a broader function called <code class="highlighter-rouge">read.table(...)</code>, with the delimiter argument (which is <code class="highlighter-rouge">sep</code>, for “separator”) set to <code class="highlighter-rouge">c</code> by default. Check out the help file for these functions:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">?</span><span class="n">read.table</span><span class="w"> </span><span class="c1"># note that `?read.csv` brings up the same help document.</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>Under the <strong>Usage</strong> section there are multiple functions listed, including <code class="highlighter-rouge">read.table(...)</code> and <code class="highlighter-rouge">read.csv(...)</code>. In the parentheses for each function there is a list of arguments. Since <code class="highlighter-rouge">read.table(...)</code> is the parent function, all arguments are listed. Only arguments with different default values (as indicated by the <code class="highlighter-rouge">=</code>) are listed for <code class="highlighter-rouge">read.csv(...)</code>. A default value is the value that each arguement assumes when you do not explicitly enter a value. For example, <code class="highlighter-rouge">read.table(...)</code> assumes that a data file has no header (<code class="highlighter-rouge">header = FALSE</code>) and no delimiting character (<code class="highlighter-rouge">sep = ""</code>) while <code class="highlighter-rouge">read.csv(...)</code> assumes that a data file does have a header (<code class="highlighter-rouge">header = TRUE</code>) and a comma as the delimiting character (<code class="highlighter-rouge">sep = ","</code>), unless you specify otherwise.</p>

<p>If your data is stored in a tab-delimited text file, you will need to use <code class="highlighter-rouge">read.table(...)</code> a different delimiting character, or another of the associated functions called <code class="highlighter-rouge">read.delim(...)</code> which has defaults to a tab-delimited file format. Note that to define a <em>tab</em> as a delimiting character, you have to us <code class="highlighter-rouge">\t</code>.</p>

<p>Let’s give it a try using a copy of the <code class="highlighter-rouge">sample.csv</code> data saved as a tab-delimited <code class="highlighter-rouge">sample.txt</code> file.</p>

<p><em>Note:</em> From the help file, <code class="highlighter-rouge">read.delim(...)</code> defaults to <code class="highlighter-rouge">header = TRUE</code> while we have to explicity definit it when using <code class="highlighter-rouge">read.table(...)</code>. We will talk about what this means in the next section.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># note that read</span><span class="w">
</span><span class="n">dat4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.delim</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/sample.txt'</span><span class="p">)</span><span class="w">
</span><span class="n">dat5</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.table</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/sample.txt'</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">dat4</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      ID Gender      Group BloodPressure  Age Aneurisms_q1 Aneurisms_q2
1 Sub001      m    Control           132 16.0          114          140
2 Sub002      m Treatment2           139 17.2          148          209
3 Sub003      m Treatment2           130 19.5          196          251
4 Sub004      f Treatment1           105 15.7          199          140
5 Sub005      m Treatment1           125 19.9          188          120
6 Sub006      M Treatment2           112 14.3          260          266
  Aneurisms_q3 Aneurisms_q4
1          202          237
2          248          248
3          122          177
4          233          220
5          222          228
6          320          294
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">dat5</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      ID Gender      Group BloodPressure  Age Aneurisms_q1 Aneurisms_q2
1 Sub001      m    Control           132 16.0          114          140
2 Sub002      m Treatment2           139 17.2          148          209
3 Sub003      m Treatment2           130 19.5          196          251
4 Sub004      f Treatment1           105 15.7          199          140
5 Sub005      m Treatment1           125 19.9          188          120
6 Sub006      M Treatment2           112 14.3          260          266
  Aneurisms_q3 Aneurisms_q4
1          202          237
2          248          248
3          122          177
4          233          220
5          222          228
6          320          294
</code></pre></div></div>

<p> </p>

<p>Now let’s take a closer look at a couple of useful arguments in <code class="highlighter-rouge">read.table(...)</code> family of functions.</p>

<p> </p>
<h4 id="the-header-argument">The <code class="highlighter-rouge">header</code> Argument</h4>

<p>The default for <code class="highlighter-rouge">read.csv(...)</code> and <code class="highlighter-rouge">read.delim(...)</code> is to set the <code class="highlighter-rouge">header</code> argument to <code class="highlighter-rouge">TRUE</code>. This means that the first row of values in the .csv or .txt is used to define the column names for the data frame. If your data set does not have a header, set the <code class="highlighter-rouge">header</code> argument to <code class="highlighter-rouge">FALSE</code>.</p>

<blockquote class="challenge">
  <h2 id="mis-loading-data-with-headers">Mis-loading data with headers</h2>

  <p>What happens if you forget to put <code class="highlighter-rouge">header = FALSE</code>? The default value is
<code class="highlighter-rouge">header = TRUE</code>, which you can check with <code class="highlighter-rouge">?read.csv</code> or <code class="highlighter-rouge">help(read.csv)</code>.
What do you expect will happen if you leave the default value?
Before you run any code, think about what will happen to the first few rows
of your data frame, and its overall size. Then run the following code and
see if your expectations agree:</p>

  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dat6</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/sample.csv'</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">dat6</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>

  <blockquote class="solution">
    <h2 id="solution-1">Solution</h2>

    <p>The <code class="highlighter-rouge">read.csv(...)</code> function sets the column names as the default values (<code class="highlighter-rouge">V1, V2, V3, ...</code>) and 
treats the first row of the <code class="highlighter-rouge">sample.csv</code> file as the first row of data. Clearly this is not the 
desired behavior for this data set, but it will be useful if you have a dataset without headers.
Note that the <code class="highlighter-rouge">V</code> is prepended just a number would not be a valid variable name.</p>
  </blockquote>
</blockquote>

<p> </p>
<h4 id="the-stringsasfactors-argument">The <code class="highlighter-rouge">stringsAsFactors</code> Argument</h4>

<p>This is perhaps the most important argument in <code class="highlighter-rouge">read.csv(...)</code>, particularly if you are working with categorical data. This is because the default behavior of R is to convert character <a href="../reference.html#string">string</a>s into factors, which may make it difficult to do such things as replace values.</p>

<p>For example, let’s look at the <code class="highlighter-rouge">car-speeds.csv</code> data set. We find out that the data collector was color blind, and accidentally recorded green cars as being blue. In order to correct the data set, let’s replace ‘Blue’ with ‘Green’ in the <code class="highlighter-rouge">$Color</code> column:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># First - load the data and take a look at what information is available</span><span class="w">
</span><span class="n">carSpeeds</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/car-speeds.csv'</span><span class="p">)</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">carSpeeds</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Color Speed     State
1  Blue    32 NewMexico
2   Red    45   Arizona
3  Blue    35  Colorado
4 White    34   Arizona
5   Red    25   Arizona
6  Blue    41   Arizona
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Next us indexing to replace all `Blue` entries in the Color column with 'Green'</span><span class="w">
</span><span class="n">carSpeeds</span><span class="o">$</span><span class="n">Color</span><span class="p">[</span><span class="n">carSpeeds</span><span class="o">$</span><span class="n">Color</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'Blue'</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Green'</span><span class="w">
</span></code></pre></div></div>

<div class="error highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Warning in `[&lt;-.factor`(`*tmp*`, carSpeeds$Color == "Blue", value =
structure(c(NA, : invalid factor level, NA generated
</code></pre></div></div>

<p> </p>

<p>What happened? The colors of the cars were loaded as factors by <code class="highlighter-rouge">read.csv(...)</code> by default. Since <code class="highlighter-rouge">Green</code> was not in the original set of colors, it was not included as a level in the factor.</p>

<p>To see the internal structure, we can use another function, <code class="highlighter-rouge">str()</code>. In this case,
the dataframe’s internal structure includes the format of each column, which is what
we are interested in. <code class="highlighter-rouge">str()</code> will be reviewed a little more in the lesson
<a href="../13-supp-data-structures/">Data Types and Structures</a>.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">str</span><span class="p">(</span><span class="n">carSpeeds</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'data.frame':	100 obs. of  3 variables:
 $ Color: Factor w/ 5 levels " Red","Black",..: NA 1 NA 5 4 NA NA 2 5 4 ...
 $ Speed: int  32 45 35 34 25 41 34 29 31 26 ...
 $ State: Factor w/ 4 levels "Arizona","Colorado",..: 3 1 2 1 1 1 3 2 1 2 ...
</code></pre></div></div>

<p> </p>

<p>We can see that the <code class="highlighter-rouge">$Color</code> and <code class="highlighter-rouge">$State</code> columns are factors and <code class="highlighter-rouge">$Speed</code> is a numeric column.</p>

<p>One way to solve this problem would be to add the <code class="highlighter-rouge">Green</code> level to the <code class="highlighter-rouge">Color</code> factor, but there is a simpler way. Let’s reload the dataset using <code class="highlighter-rouge">stringsAsFactors = FALSE</code>, and see what happens when we try to replace ‘Blue’ with ‘Green’ in the <code class="highlighter-rouge">$Color</code> column:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># First - load the data and take a look at what information is available</span><span class="w">
</span><span class="n">carSpeeds</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/car-speeds.csv'</span><span class="p">,</span><span class="w"> </span><span class="n">stringsAsFactors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="n">str</span><span class="p">(</span><span class="n">carSpeeds</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'data.frame':	100 obs. of  3 variables:
 $ Color: chr  "Blue" " Red" "Blue" "White" ...
 $ Speed: int  32 45 35 34 25 41 34 29 31 26 ...
 $ State: chr  "NewMexico" "Arizona" "Colorado" "Arizona" ...
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Next us indexing to replace all `Blue` entries in the Color column with 'Green'</span><span class="w">
</span><span class="n">carSpeeds</span><span class="o">$</span><span class="n">Color</span><span class="p">[</span><span class="n">carSpeeds</span><span class="o">$</span><span class="n">Color</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'Blue'</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Green'</span><span class="w">
</span><span class="n">carSpeeds</span><span class="o">$</span><span class="n">Color</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [1] "Green" " Red"  "Green" "White" "Red"   "Green" "Green" "Black"
  [9] "White" "Red"   "Red"   "White" "Green" "Green" "Black" "Red"  
 [17] "Green" "Green" "White" "Green" "Green" "Green" "Red"   "Green"
 [25] "Red"   "Red"   "Red"   "Red"   "White" "Green" "Red"   "White"
 [33] "Black" "Red"   "Black" "Black" "Green" "Red"   "Black" "Red"  
 [41] "Black" "Black" "Red"   "Red"   "White" "Black" "Green" "Red"  
 [49] "Red"   "Black" "Black" "Red"   "White" "Red"   "Green" "Green"
 [57] "Black" "Green" "White" "Black" "Red"   "Green" "Green" "White"
 [65] "Black" "Red"   "Red"   "Black" "Green" "White" "Green" "Red"  
 [73] "White" "White" "Green" "Green" "Green" "Green" "Green" "White"
 [81] "Black" "Green" "White" "Black" "Black" "Red"   "Red"   "White"
 [89] "White" "White" "White" "Red"   "Red"   "Red"   "White" "Black"
 [97] "White" "Black" "Black" "White"
</code></pre></div></div>

<p> </p>

<p>That’s better! And we can see how the data now is read as character instead of factor.</p>

<hr />
<h3 id="writing-tabular-data-to-a-file-csv-txt">Writing tabular data to a file (.csv, .txt)</h3>

<p>After altering our cars dataset by replacing ‘Blue’ with ‘Green’ in the <code class="highlighter-rouge">$Color</code> column, we now want to save the output. The <code class="highlighter-rouge">read.table(...)</code> function family has a corresponding set of <code class="highlighter-rouge">write.table(...)</code> functions. These functions have a familiar set of arguments:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">?</span><span class="n">read.table</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>Here is the basic format for writing a table:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Export the data. The write.csv() function requires a minimum of two</span><span class="w">
</span><span class="c1"># arguments, the data to be saved and the name of the output file.</span><span class="w">

</span><span class="n">write.csv</span><span class="p">(</span><span class="n">carSpeeds</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/car-speeds-cleaned.csv'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>If you open the file, you’ll see that it has header names, because the data had headers within R, but that there are also numbers in the first column.</p>

<p><img src="../fig/01-supp-csv-with-row-nums.png" title="plot of chunk unnamed-chunk-14" alt="plot of chunk unnamed-chunk-14" width="350px" style="display: block; margin: auto auto auto 0;" /></p>

<p> </p>

<p>This extra column can cause problems when trying to open data in some other programs, and in most cases you won’t want to explicity name the rows. This can be easily disabled with a simple argument:</p>

<p> </p>
<h4 id="the-rownames-argument">The <code class="highlighter-rouge">row.names</code> Argument</h4>

<p>This argument allows us to set the names of the rows in the output data file. R’s default for this argument is <code class="highlighter-rouge">TRUE</code>, and since it does not know what else to name the rows for the cars data set, it resorts to using row numbers. To turn row numbers off, we can set <code class="highlighter-rouge">row.names</code> to <code class="highlighter-rouge">FALSE</code>:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">write.csv</span><span class="p">(</span><span class="n">carSpeeds</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/car-speeds-cleaned.csv'</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Now we see:</p>

<p><img src="../fig/01-supp-csv-without-row-nums.png" title="plot of chunk unnamed-chunk-16" alt="plot of chunk unnamed-chunk-16" width="350px" style="display: block; margin: auto auto auto 0;" /></p>

<p> </p>

<blockquote class="callout">
  <h2 id="setting-column-names">Setting Column Names</h2>

  <p>There is also a <code class="highlighter-rouge">col.names</code> argument, which can be used to set the column
names for a data set without headers. If the data set already has headers
(e.g., we used the <code class="highlighter-rouge">headers = TRUE</code> argument when importing the data) then a
<code class="highlighter-rouge">col.names</code> argument will be ignored.</p>
</blockquote>

<p> </p>
<h4 id="the-na-argument">The <code class="highlighter-rouge">na</code> Argument</h4>

<p>There are times when we want to specify certain values for <code class="highlighter-rouge">NA</code>s in the data set (e.g., we are going to pass the data to a program that only accepts -9999 as a nodata value). In this case, we want to set the <code class="highlighter-rouge">NA</code> value of our output file to the desired value, using the na argument. Let’s see how this works:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># First, replace the speed in the 3rd row with NA, by using an index (square</span><span class="w">
</span><span class="c1"># brackets to indicate the position of the value we want to replace)</span><span class="w">
</span><span class="n">carSpeeds</span><span class="o">$</span><span class="n">Speed</span><span class="p">[</span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">carSpeeds</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Color Speed     State
1 Green    32 NewMexico
2   Red    45   Arizona
3 Green    NA  Colorado
4 White    34   Arizona
5   Red    25   Arizona
6 Green    41   Arizona
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">write.csv</span><span class="p">(</span><span class="n">carSpeeds</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/car-speeds-cleaned.csv'</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>Now we’ll set <code class="highlighter-rouge">NA</code> to -9999 when we write the new .csv file:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Note - the na argument requires a string input</span><span class="w">
</span><span class="n">write.csv</span><span class="p">(</span><span class="n">carSpeeds</span><span class="p">,</span><span class="w">
          </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/car-speeds-cleaned.csv'</span><span class="p">,</span><span class="w">
          </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w">
          </span><span class="n">na</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'-9999'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>And we see:</p>

<p><img src="../fig/01-supp-csv-with-special-NA.png" title="plot of chunk unnamed-chunk-19" alt="plot of chunk unnamed-chunk-19" width="350px" style="display: block; margin: auto auto auto 0;" /></p>

<p> </p>

<p>This can be useful when exporting data from R in a different program that either does not recognize <code class="highlighter-rouge">NA</code> or uses a different symbol for missing data.</p>

<hr />
<h3 id="manipulating-data">Manipulating Data</h3>

<p>Now that our data are loaded into R, we can start doing things with them.
First, let’s ask what type of thing <code class="highlighter-rouge">dat</code> is:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">class</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] "data.frame"
</code></pre></div></div>

<p> </p>

<p>The output tells us that it’s a data frame. As noted in the previous lesson, data frames are the <em>de facto</em> data type in R, and many functions will produce data frames as output.</p>

<p>We can see the shape, or <a href="../reference.html#dimensions-of-an-array">dimensions</a>, of the data frame with the function <code class="highlighter-rouge">dim</code>:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">dim</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 100   9
</code></pre></div></div>

<p> </p>

<p>This tells us that our data frame, <code class="highlighter-rouge">dat</code>, has 100 rows and 9 columns.</p>

<p>Reviewing the basic types of subsetting, if we want to get a single value from the data frame, we can provide an <a href="../reference.html#index">index</a> in square brackets. The first number specifies the row and the second the column:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># first value in dat, row 1, column 1</span><span class="w">
</span><span class="n">dat</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] Sub001
100 Levels: Sub001 Sub002 Sub003 Sub004 Sub005 Sub006 Sub007 ... Sub100
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># middle value in dat, row 30, column 6</span><span class="w">
</span><span class="n">dat</span><span class="p">[</span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 103
</code></pre></div></div>

<p> </p>

<p>Or we can select sequential or non-sequential subsets using the <code class="highlighter-rouge">:</code> operator or <code class="highlighter-rouge">c()</code> function, respectively:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># output the first 4 rows and first 3 columns of dat</span><span class="w">
</span><span class="n">dat</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      ID Gender      Group
1 Sub001      m    Control
2 Sub002      m Treatment2
3 Sub003      m Treatment2
4 Sub004      f Treatment1
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># output rows 1, 3, and, 5, and columsn 2 and 6</span><span class="w">
</span><span class="n">dat</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">)]</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Gender Aneurisms_q1
1      m          114
3      m          196
5      m          188
</code></pre></div></div>

<p> </p>

<p>If you want to select all rows or all columns, leave that index value empty.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># All columns from row 5</span><span class="w">
</span><span class="n">dat</span><span class="p">[</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      ID Gender      Group BloodPressure  Age Aneurisms_q1 Aneurisms_q2
5 Sub005      m Treatment1           125 19.9          188          120
  Aneurisms_q3 Aneurisms_q4
5          222          228
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># All rows from column 16-18</span><span class="w">
</span><span class="n">dat</span><span class="p">[,</span><span class="w"> </span><span class="m">16</span><span class="o">:</span><span class="m">18</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<div class="error highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Error in `[.data.frame`(dat, , 16:18): undefined columns selected
</code></pre></div></div>

<p> </p>

<p>Or select columns by name:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># select the BloodPressure data</span><span class="w">
</span><span class="n">dat</span><span class="o">$</span><span class="n">BloodPressure</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [1] 132 139 130 105 125 112 173 108 131 129 126  96  77 158  81 137 147
 [18] 130 105  92 111 122  97 118  82 123 126  94 135 108 133 108 122 134
 [35] 145 133  90 118 113 115 142 114 139  90 126 109 125  99 122 111 109
 [52] 134 113 105 125 123 155 117 116 133  94 106 144 149 108 116 136  98
 [69] 148  74 147 116 133  97 132 153 151 121 116 104 111  62 124 124 109
 [86] 117  90 158 113 150 115  83 116 141 108 102  90 133  83 122
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># select all rows for the Gender and BloodPressure columns</span><span class="w">
</span><span class="n">dat</span><span class="p">[,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Gender"</span><span class="p">,</span><span class="w"> </span><span class="s2">"BloodPressure"</span><span class="p">)]</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    Gender BloodPressure
1        m           132
2        m           139
3        m           130
4        f           105
5        m           125
6        M           112
7        f           173
8        m           108
9        m           131
10       f           129
11       m           126
12       f            96
13       f            77
14       m           158
15       m            81
16       m           137
17       f           147
18       m           130
19       m           105
20       F            92
21       f           111
22       m           122
23       f            97
24       f           118
25       m            82
26       M           123
27       M           126
28       f            94
29       m           135
30       f           108
31       f           133
32       m           108
33       m           122
34       m           134
35       m           145
36       f           133
37       f            90
38       m           118
39       M           113
40       m           115
41       f           142
42       m           114
43       m           139
44       m            90
45       f           126
46       f           109
47       M           125
48       M            99
49       m           122
50       m           111
51       m           109
52       f           134
53       f           113
54       f           105
55       m           125
56       f           123
57       m           155
58       m           117
59       m           116
60       f           133
61       f            94
62       f           106
63       f           144
64       M           149
65       f           108
66       m           116
67       f           136
68       f            98
69       M           148
70       m            74
71       m           147
72       m           116
73       F           133
74       m            97
75       m           132
76       f           153
77       M           151
78       M           121
79       M           116
80       f           104
81       m           111
82       M            62
83       M           124
84       m           124
85       m           109
86       f           117
87       f            90
88       f           158
89       m           113
90       m           150
91       f           115
92       m            83
93       F           116
94       f           141
95       m           108
96       m           102
97       F            90
98       m           133
99       M            83
100      M           122
</code></pre></div></div>

<p>If you leave both index values empty (i.e., <code class="highlighter-rouge">dat[,]</code>), you get the entire data frame.</p>

<hr />
<h3 id="calculating-basic-statistics">Calculating basic statistics</h3>

<p>Now let’s perform some common mathematical operations to learn more about our data. Before we begin, let’s clean up our environment and reload our sample data to reset any unintended changes and be sure that we include <code class="highlighter-rouge">header=TRUE</code> and <code class="highlighter-rouge">stringsAsFactors=FALSE</code>.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rm</span><span class="p">(</span><span class="n">list</span><span class="o">=</span><span class="n">ls</span><span class="p">())</span><span class="w">
</span><span class="n">dat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s2">"data/sample.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">stringsAsFactors</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>This data is the results of an (not real) experiment, looking at the number of aneurysms that formed in the eyes of patients who undertook 3 different treatments.</p>

<p>When analyzing data we often want to look at partial statistics, such as the maximum value per patient or the average value per day.
One way to do this is to select the data we want to create a new temporary data frame, and then perform the calculation on this subset:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># first row, all of the columns</span><span class="w">
</span><span class="n">patient_1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dat</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="c1"># max inflammation for patient 1</span><span class="w">
</span><span class="nf">max</span><span class="p">(</span><span class="n">patient_1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="error highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Error in FUN(X[[i]], ...): only defined on a data frame with all numeric variables
</code></pre></div></div>
<!-- 
    OUCH!! The following may be true, but it will vary by R version, not by
    installation! There shouldn't be an issue with a data frame where all
    columns are numeric without missing values. Under those circumstances,
    coercion should do what you expect. You'll get problems with mixed
    types (factors, character etc), or with missing values. If this is
    actually a problem, we need to change the example - we should be able
    to come up with an example that doesn't require this ugliness in the
    very first lesson. 
    
    Also, columns always work as expected because by definition a column
    contains a vector of values of the same type. Rows include values from
    different columns, which of course can be different types. This doesn't
    need to be confusing, and if we're careful in our presentation here we
    can avoid this until the students know enough to cope rationally.
-->

<!--
> ## Forcing Conversion
>
> The code above may give you an error in some R installations,
> since R does not automatically convert a row from a `data.frame` to a vector.
> (Confusingly, subsetted columns are automatically converted.)
> If this happens, you can use the `as.numeric` command to convert the row of data to a numeric vector:
>
> `patient_1 <- as.numeric(dat[1, ])`
>
> `max(patient_1)`
>
> You can also check the `class` of each object:
>
> `class(dat[1, ])`
>
> `class(as.numeric(dat[1, ]))`
{: .callout}
-->

<p>We don’t actually need to store the row in a variable of its own.
Instead, we can combine the selection and the function call:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># max inflammation for patient 2</span><span class="w">
</span><span class="nf">max</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="p">])</span><span class="w">
</span></code></pre></div></div>

<div class="error highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Error in FUN(X[[i]], ...): only defined on a data frame with all numeric variables
</code></pre></div></div>

<p>R also has functions for other common calculations, e.g. finding the minimum, mean, median, and standard deviation of the data:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># minimum inflammation on day 7</span><span class="w">
</span><span class="nf">min</span><span class="p">(</span><span class="n">dat</span><span class="p">[,</span><span class="w"> </span><span class="m">7</span><span class="p">])</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 80
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># mean inflammation on day 7</span><span class="w">
</span><span class="n">mean</span><span class="p">(</span><span class="n">dat</span><span class="p">[,</span><span class="w"> </span><span class="m">7</span><span class="p">])</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 168.03
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># median inflammation on day 7</span><span class="w">
</span><span class="n">median</span><span class="p">(</span><span class="n">dat</span><span class="p">[,</span><span class="w"> </span><span class="m">7</span><span class="p">])</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 162.5
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># standard deviation of inflammation on day 7</span><span class="w">
</span><span class="n">sd</span><span class="p">(</span><span class="n">dat</span><span class="p">[,</span><span class="w"> </span><span class="m">7</span><span class="p">])</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 48.47543
</code></pre></div></div>

<blockquote class="callout">
  <h2 id="forcing-conversion">Forcing Conversion</h2>

  <p>Note that R may return an error when you attempt to perform similar calculations on 
subsetted <em>rows</em> of data frames. This is because some functions in R automatically convert 
the object type to a numeric vector, while others do not (e.g. <code class="highlighter-rouge">max(dat[1, ])</code> works as 
expected, while <code class="highlighter-rouge">mean(dat[1, ])</code> returns <code class="highlighter-rouge">NA</code> and a warning). You get the
expected output by including an
explicit call to <code class="highlighter-rouge">as.numeric()</code>, e.g. <code class="highlighter-rouge">mean(as.numeric(dat[1, ]))</code>. By contrast, 
calculations on subsetted <em>columns</em> always work as expected, since columns of data frames 
are already defined as vectors.</p>
</blockquote>

<p>R also has a function that summaries the previous common calculations:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Summarize function</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">dat</span><span class="p">[,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      ID               Gender             Group           BloodPressure  
 Length:100         Length:100         Length:100         Min.   : 62.0  
 Class :character   Class :character   Class :character   1st Qu.:107.5  
 Mode  :character   Mode  :character   Mode  :character   Median :117.5  
                                                          Mean   :118.6  
                                                          3rd Qu.:133.0  
                                                          Max.   :173.0  
</code></pre></div></div>

<p>For every column in the data frame, the function “summary” calculates: the minimun value, the first quartile, the median, the mean, the third quartile and the max value, giving helpful details about the sample distribution.</p>

<p>What if we need the maximum inflammation for all patients, or the average for each day?
As the diagram below shows, we want to perform the operation across a margin of the data frame:</p>

<p><img src="../fig/r-operations-across-margins.svg" alt="Operations Across Margins" /></p>

<p>To support this, we can use the <code class="highlighter-rouge">apply</code> function.</p>

<blockquote class="callout">
  <h2 id="getting-help">Getting Help</h2>

  <p>To learn about a function in R, e.g. <code class="highlighter-rouge">apply</code>, we can read its help
documention by running <code class="highlighter-rouge">help(apply)</code> or <code class="highlighter-rouge">?apply</code>.</p>
</blockquote>

<p><code class="highlighter-rouge">apply</code> allows us to repeat a function on all of the rows (<code class="highlighter-rouge">MARGIN = 1</code>) or columns (<code class="highlighter-rouge">MARGIN = 2</code>) of a data frame.</p>

<p>Thus, to obtain the average inflammation of each patient we will need to calculate the mean of all of the rows (<code class="highlighter-rouge">MARGIN = 1</code>) of the data frame.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">avg_patient_inflammation</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="error highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
</code></pre></div></div>

<p>And to obtain the average inflammation of each day we will need to calculate the mean of all of the columns (<code class="highlighter-rouge">MARGIN = 2</code>) of the data frame.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">avg_day_inflammation</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="error highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
Warning in mean.default(newX[, i], ...): argument is not numeric or
logical: returning NA
</code></pre></div></div>

<p>Since the second argument to <code class="highlighter-rouge">apply</code> is <code class="highlighter-rouge">MARGIN</code>, the above command is equivalent to <code class="highlighter-rouge">apply(dat, MARGIN = 2, mean)</code>.
We’ll learn why this is so in the next lesson.</p>

<blockquote class="callout">
  <h2 id="efficient-alternatives">Efficient Alternatives</h2>

  <p>Some common operations have more efficient alternatives. For example, you
can calculate the row-wise or column-wise means with <code class="highlighter-rouge">rowMeans</code> and
<code class="highlighter-rouge">colMeans</code>, respectively.</p>
</blockquote>

<blockquote class="challenge">
  <h2 id="subsetting-data">Subsetting Data</h2>

  <p>We can take subsets of character vectors as well:</p>

  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">animal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"m"</span><span class="p">,</span><span class="w"> </span><span class="s2">"o"</span><span class="p">,</span><span class="w"> </span><span class="s2">"n"</span><span class="p">,</span><span class="w"> </span><span class="s2">"k"</span><span class="p">,</span><span class="w"> </span><span class="s2">"e"</span><span class="p">,</span><span class="w"> </span><span class="s2">"y"</span><span class="p">)</span><span class="w">
</span><span class="c1"># first three characters</span><span class="w">
</span><span class="n">animal</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">]</span><span class="w">
</span></code></pre></div>  </div>

  <div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] "m" "o" "n"
</code></pre></div>  </div>

  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># last three characters</span><span class="w">
</span><span class="n">animal</span><span class="p">[</span><span class="m">4</span><span class="o">:</span><span class="m">6</span><span class="p">]</span><span class="w">
</span></code></pre></div>  </div>

  <div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] "k" "e" "y"
</code></pre></div>  </div>

  <ol class="solution">
    <li>
      <p>If the first four characters are selected using the subset <code class="highlighter-rouge">animal[1:4]</code>, how can we obtain the first four characters in reverse order?</p>
    </li>
    <li>
      <p>What is <code class="highlighter-rouge">animal[-1]</code>?
   What is <code class="highlighter-rouge">animal[-4]</code>?
   Given those answers,
   explain what <code class="highlighter-rouge">animal[-1:-4]</code> does.</p>
    </li>
    <li>
      <p>Use a subset of <code class="highlighter-rouge">animal</code> to create a new character vector that spells the word “eon”, i.e. <code class="highlighter-rouge">c("e", "o", "n")</code>.</p>
      <blockquote>
        <h2 id="solutions">Solutions</h2>

        <ol>
          <li>
            <p><code class="highlighter-rouge">animal[4:1]</code></p>
          </li>
          <li>
            <p><code class="highlighter-rouge">"o" "n" "k" "e" "y"</code> and <code class="highlighter-rouge">"m" "o" "n" "e" "y"</code>, which means that a
single <code class="highlighter-rouge">-</code> removes the element at the given index position.
<code class="highlighter-rouge">animal[-1:-4]</code> remove the subset, returning <code class="highlighter-rouge">"e" "y"</code>, which is
equivalent to <code class="highlighter-rouge">animal[5:6]</code>.</p>
          </li>
          <li>
            <p><code class="highlighter-rouge">animal[c(5,2,3)]</code> combines indexing with the <code class="highlighter-rouge">c</code>ombine function.</p>
          </li>
        </ol>

      </blockquote>
    </li>
  </ol>
</blockquote>

<blockquote class="challenge">
  <h2 id="subsetting-more-data">Subsetting More Data</h2>

  <p>Suppose you want to determine the maximum inflammation for patient 5 across days three to seven.
To do this you would extract the relevant subset from the data frame and calculate the maximum value.
Which of the following lines of R code gives the correct answer?</p>

  <ol>
    <li><code class="highlighter-rouge">max(dat[5, ])</code></li>
    <li><code class="highlighter-rouge">max(dat[3:7, 5])</code></li>
    <li><code class="highlighter-rouge">max(dat[5, 3:7])</code></li>
    <li><code class="highlighter-rouge">max(dat[5, 3, 7])</code></li>
  </ol>

  <blockquote class="solution">
    <h2 id="solution-2">Solution</h2>

    <p>Answer: 3</p>

    <p>Explanation: You want to extract the part of the dataframe representing data for patient 5 from days three to seven. In this dataframe, patient data is organised in rows and the days are represented by the columns. Subscripting in R follows the <code class="highlighter-rouge">[i, j]</code> principle, where <code class="highlighter-rouge">i = rows</code> and <code class="highlighter-rouge">j = columns</code>. Thus, answer 3 is correct since the patient is represented by the value for i (5) and the days are represented by the values in j, which is a subset spanning day 3 to 7.</p>

  </blockquote>
</blockquote>

<blockquote class="challenge">
  <h2 id="subsetting-and-re-assignment">Subsetting and Re-Assignment</h2>

  <p>Using the inflammation data frame <code class="highlighter-rouge">dat</code> from above:
Let’s pretend there was something wrong with the instrument on the first five days for every second patient (#2, 4, 6, etc.), which resulted in the measurements being twice as large as they should be.</p>

  <ol>
    <li>Write a vector containing each affected patient (hint: <code class="highlighter-rouge">?seq</code>)</li>
    <li>Create a new data frame in which you halve the first five days’ values in only those patients</li>
    <li>Print out the corrected data frame to check that your code has fixed the problem</li>
  </ol>

  <blockquote class="solution">
    <h2 id="solution-3">Solution</h2>
    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">whichPatients</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">60</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="c1"># i.e., which rows</span><span class="w">
</span><span class="n">whichDays</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">)</span><span class="w">         </span><span class="c1"># i.e., which columns</span><span class="w">
</span><span class="n">dat2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dat</span><span class="w">
</span><span class="c1"># check the size of your subset: returns `30 5`, that is 30 [rows=patients] by 5 [columns=days]</span><span class="w">
</span><span class="nf">dim</span><span class="p">(</span><span class="n">dat2</span><span class="p">[</span><span class="n">whichPatients</span><span class="p">,</span><span class="w"> </span><span class="n">whichDays</span><span class="p">])</span><span class="w">
</span><span class="n">dat2</span><span class="p">[</span><span class="n">whichPatients</span><span class="p">,</span><span class="w"> </span><span class="n">whichDays</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dat2</span><span class="p">[</span><span class="n">whichPatients</span><span class="p">,</span><span class="w"> </span><span class="n">whichDays</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span><span class="w">
</span><span class="n">dat2</span><span class="w">
</span></code></pre></div>    </div>
  </blockquote>
</blockquote>

<blockquote class="challenge">
  <h2 id="using-the-apply-function-on-patient-data">Using the Apply Function on Patient Data</h2>

  <p>Challenge: the apply function can be used to summarize datasets and subsets
of data across rows and columns using the MARGIN argument.
Suppose you want to calculate the mean inflammation for specific days and patients
in the patient dataset (i.e. 60 patients across 40 days).</p>

  <p>Please use a combination of the apply function and indexing to:</p>

  <ol>
    <li>calculate the mean inflammation for patients 1 to 5 over the whole 40 days</li>
    <li>calculate the mean inflammation for days 1 to 10 (across all patients).</li>
    <li>calculate the mean inflammation for every second day (across all patients).</li>
  </ol>

  <p>Think about the number of rows and columns you would expect as the result before each
apply call and check your intuition by applying the mean function.</p>

  <blockquote class="solution">
    <h2 id="solution-4">Solution</h2>
    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 1.</span><span class="w">
</span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="p">],</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w">
</span><span class="c1"># 2.</span><span class="w">
</span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">[,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">],</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w">
</span><span class="c1"># 3.</span><span class="w">
</span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">[,</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">40</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)],</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
  </blockquote>
</blockquote>

<h3 id="basic-data-statistics">Basic data statistics</h3>

<p>It’s hard to tell from the default output whether the result is correct, but there are a few simple tests that will reassure us:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># original min</span><span class="w">
</span><span class="nf">min</span><span class="p">(</span><span class="n">dat</span><span class="p">[,</span><span class="w"> </span><span class="m">4</span><span class="p">])</span><span class="w">
</span><span class="c1"># original mean</span><span class="w">
</span><span class="n">mean</span><span class="p">(</span><span class="n">dat</span><span class="p">[,</span><span class="w"> </span><span class="m">4</span><span class="p">])</span><span class="w">
</span><span class="c1"># original max</span><span class="w">
</span><span class="nf">max</span><span class="p">(</span><span class="n">dat</span><span class="p">[,</span><span class="w"> </span><span class="m">4</span><span class="p">])</span><span class="w">
</span><span class="c1"># centered min</span><span class="w">
</span><span class="nf">min</span><span class="p">(</span><span class="n">centered</span><span class="p">)</span><span class="w">
</span><span class="c1"># centered mean</span><span class="w">
</span><span class="n">mean</span><span class="p">(</span><span class="n">centered</span><span class="p">)</span><span class="w">
</span><span class="c1"># centered max</span><span class="w">
</span><span class="nf">max</span><span class="p">(</span><span class="n">centered</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>That seems almost right: the original mean was about 118.61, so the lower bound from zero is now about -118.61.
The mean of the centered data is <code class="highlighter-rouge">mean(centered)</code>.
We can even go further and check that the standard deviation hasn’t changed:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># original standard deviation</span><span class="w">
</span><span class="n">sd</span><span class="p">(</span><span class="n">dat</span><span class="p">[,</span><span class="w"> </span><span class="m">4</span><span class="p">])</span><span class="w">
</span><span class="c1"># centered standard deviation</span><span class="w">
</span><span class="n">sd</span><span class="p">(</span><span class="n">centered</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Those values look the same, but we probably wouldn’t notice if they were different in the sixth decimal place.
Let’s do this instead:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># difference in standard deviations before and after</span><span class="w">
</span><span class="n">sd</span><span class="p">(</span><span class="n">dat</span><span class="p">[,</span><span class="w"> </span><span class="m">4</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sd</span><span class="p">(</span><span class="n">centered</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Sometimes, a very small difference can be detected due to rounding at very low decimal places.
R has a useful function for comparing two objects allowing for rounding errors, <code class="highlighter-rouge">all.equal</code>:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">all.equal</span><span class="p">(</span><span class="n">sd</span><span class="p">(</span><span class="n">dat</span><span class="p">[,</span><span class="w"> </span><span class="m">4</span><span class="p">]),</span><span class="w"> </span><span class="n">sd</span><span class="p">(</span><span class="n">centered</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<h3 id="plotting">Plotting</h3>

<p>The mathematician Richard Hamming once said, “The purpose of computing is insight, not numbers,” and the best way to develop insight is often to visualize data.
Visualization deserves an entire lecture (or course) of its own, but we can explore a few of R’s plotting features.</p>

<p>Let’s take a look at the average inflammation over time.
Recall that we already calculated these values above using <code class="highlighter-rouge">apply(dat, 2, mean)</code> and saved them in the variable <code class="highlighter-rouge">avg_day_inflammation</code>.
Plotting the values is done with the function <code class="highlighter-rouge">plot</code>.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">avg_day_inflammation</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="error highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Warning in min(x): no non-missing arguments to min; returning Inf
</code></pre></div></div>

<div class="error highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Warning in max(x): no non-missing arguments to max; returning -Inf
</code></pre></div></div>

<div class="error highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Error in plot.window(...): need finite 'ylim' values
</code></pre></div></div>

<p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-36-1.png" title="plot of chunk unnamed-chunk-36" alt="plot of chunk unnamed-chunk-36" width="612" style="display: block; margin: auto;" /></p>

<p>Above, we gave the function <code class="highlighter-rouge">plot</code> a vector of numbers corresponding to the average inflammation per day across all patients.
<code class="highlighter-rouge">plot</code> created a scatter plot where the y-axis is the average inflammation level and the x-axis is the order, or index, of the values in the vector, which in this case correspond to the 40 days of treatment.
The result is roughly a linear rise and fall, which is suspicious: based on other studies, we expect a sharper rise and slower fall.
Let’s have a look at two other statistics: the maximum and minimum inflammation per day.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">max_day_inflammation</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">max_day_inflammation</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="error highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Warning in xy.coords(x, y, xlabel, ylabel, log): NAs introduced by coercion
</code></pre></div></div>

<p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-37-1.png" title="plot of chunk unnamed-chunk-37" alt="plot of chunk unnamed-chunk-37" width="612" style="display: block; margin: auto;" /></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">min_day_inflammation</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">min_day_inflammation</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="error highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Warning in xy.coords(x, y, xlabel, ylabel, log): NAs introduced by coercion
</code></pre></div></div>

<p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-38-1.png" title="plot of chunk unnamed-chunk-38" alt="plot of chunk unnamed-chunk-38" width="612" style="display: block; margin: auto;" /></p>

<p>The maximum value rises and falls perfectly smoothly, while the minimum seems to be a step function. Neither result seems particularly likely, so either there’s a mistake in our calculations or something is wrong with our data.</p>

<blockquote class="challenge">
  <h2 id="plotting-data">Plotting Data</h2>

  <p>Create a plot showing the standard deviation of the inflammation data for each day across all patients.</p>

  <blockquote class="solution">
    <h2 id="solution-5">Solution</h2>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sd_day_inflammation</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">sd_day_inflammation</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
  </blockquote>
</blockquote>

<h3 id="saving-plots-to-a-file">Saving Plots to a File</h3>

<p>So far, we have built a function <code class="highlighter-rouge">analyze</code> to plot summary statistics of the inflammation data:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">analyze</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="c1"># Plots the average, min, and max inflammation over time.</span><span class="w">
  </span><span class="c1"># Input is character string of a csv file.</span><span class="w">
  </span><span class="n">dat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
  </span><span class="n">avg_day_inflammation</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w">
  </span><span class="n">plot</span><span class="p">(</span><span class="n">avg_day_inflammation</span><span class="p">)</span><span class="w">
  </span><span class="n">max_day_inflammation</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="p">)</span><span class="w">
  </span><span class="n">plot</span><span class="p">(</span><span class="n">max_day_inflammation</span><span class="p">)</span><span class="w">
  </span><span class="n">min_day_inflammation</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="p">)</span><span class="w">
  </span><span class="n">plot</span><span class="p">(</span><span class="n">min_day_inflammation</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>And also built the function <code class="highlighter-rouge">analyze_all</code> to automate the processing of each data file:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">analyze_all</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">folder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"data"</span><span class="p">,</span><span class="w"> </span><span class="n">pattern</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="c1"># Runs the function analyze for each file in the given folder</span><span class="w">
  </span><span class="c1"># that contains the given pattern.</span><span class="w">
  </span><span class="n">filenames</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">list.files</span><span class="p">(</span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">folder</span><span class="p">,</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pattern</span><span class="p">,</span><span class="w"> </span><span class="n">full.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">filenames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">analyze</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>While these are useful in an interactive R session, what if we want to send our results to our collaborators?
Since we currently have 12 data sets, running <code class="highlighter-rouge">analyze_all</code> creates 36 plots.
Saving each of these individually would be tedious and error-prone.
And in the likely situation that we want to change how the data is processed or the look of the plots, we would have to once again save all 36 before sharing the updated results with our collaborators.</p>

<p>Here’s how we can save all three plots of the first inflammation data set in a pdf file:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pdf</span><span class="p">(</span><span class="s2">"inflammation-01.pdf"</span><span class="p">)</span><span class="w">
</span><span class="n">analyze</span><span class="p">(</span><span class="s2">"data/inflammation-01.csv"</span><span class="p">)</span><span class="w">
</span><span class="n">dev.off</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p>The function <code class="highlighter-rouge">pdf</code> redirects all the plots generated by R into a pdf file, which in this case we have named “inflammation-01.pdf”.
After we are done generating the plots to be saved in the pdf file, we stop R from redirecting plots with the function <code class="highlighter-rouge">dev.off</code>.</p>

<blockquote class="callout">
  <h2 id="overwriting-plots">Overwriting Plots</h2>

  <p>If you run <code class="highlighter-rouge">pdf</code> multiple times without running <code class="highlighter-rouge">dev.off</code>, you will save plots to the most recently opened file.
However, you won’t be able to open the previous pdf files because the connections were not closed.
In order to get out of this situation, you’ll need to run <code class="highlighter-rouge">dev.off</code> until all the pdf connections are closed.
You can check your current status using the function <code class="highlighter-rouge">dev.cur</code>.
If it says “pdf”, all your plots are being saved in the last pdf specified.
If it says “null device” or “RStudioGD”, the plots will be visualized normally.</p>
</blockquote>

<p>We can update the <code class="highlighter-rouge">analyze</code> function so that it always saves the plots in a pdf.
But that would make it more difficult to interactively test out new changes.
It would be ideal if <code class="highlighter-rouge">analyze</code> would either save or not save the plots based on its input.</p>

<h3 id="saving-automatically-generated-figures">Saving Automatically Generated Figures</h3>

<p>Now that we know how to have R make decisions based on input values,
let’s update <code class="highlighter-rouge">analyze</code>:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">analyze</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="c1"># Plots the average, min, and max inflammation over time.</span><span class="w">
  </span><span class="c1"># Input:</span><span class="w">
  </span><span class="c1">#    filename: character string of a csv file</span><span class="w">
  </span><span class="c1">#    output: character string of pdf file for saving</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nf">is.null</span><span class="p">(</span><span class="n">output</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">pdf</span><span class="p">(</span><span class="n">output</span><span class="p">)</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="n">dat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
  </span><span class="n">avg_day_inflammation</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w">
  </span><span class="n">plot</span><span class="p">(</span><span class="n">avg_day_inflammation</span><span class="p">)</span><span class="w">
  </span><span class="n">max_day_inflammation</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="p">)</span><span class="w">
  </span><span class="n">plot</span><span class="p">(</span><span class="n">max_day_inflammation</span><span class="p">)</span><span class="w">
  </span><span class="n">min_day_inflammation</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="p">)</span><span class="w">
  </span><span class="n">plot</span><span class="p">(</span><span class="n">min_day_inflammation</span><span class="p">)</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nf">is.null</span><span class="p">(</span><span class="n">output</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">dev.off</span><span class="p">()</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>We added an argument, <code class="highlighter-rouge">output</code>, that by default is set to <code class="highlighter-rouge">NULL</code>.
An <code class="highlighter-rouge">if</code> statement at the beginning checks the argument <code class="highlighter-rouge">output</code> to decide whether or not to save the plots to a pdf.
Let’s break it down.
The function <code class="highlighter-rouge">is.null</code> returns <code class="highlighter-rouge">TRUE</code> if a variable is <code class="highlighter-rouge">NULL</code> and <code class="highlighter-rouge">FALSE</code> otherwise.
The exclamation mark, <code class="highlighter-rouge">!</code>, stands for “not”.
Therefore the line in the <code class="highlighter-rouge">if</code> block is only executed if <code class="highlighter-rouge">output</code> is “not null”.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">output</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NULL</span><span class="w">
</span><span class="nf">is.null</span><span class="p">(</span><span class="n">output</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] TRUE
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">!</span><span class="nf">is.null</span><span class="p">(</span><span class="n">output</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] FALSE
</code></pre></div></div>

<p>Now we can use <code class="highlighter-rouge">analyze</code> interactively, as before,</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">analyze</span><span class="p">(</span><span class="s2">"data/inflammation-01.csv"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-44-1.png" title="plot of chunk unnamed-chunk-44" alt="plot of chunk unnamed-chunk-44" width="612" style="display: block; margin: auto;" /><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-44-2.png" title="plot of chunk unnamed-chunk-44" alt="plot of chunk unnamed-chunk-44" width="612" style="display: block; margin: auto;" /><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-44-3.png" title="plot of chunk unnamed-chunk-44" alt="plot of chunk unnamed-chunk-44" width="612" style="display: block; margin: auto;" /></p>

<p>but also use it to save plots,</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">analyze</span><span class="p">(</span><span class="s2">"data/inflammation-01.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"inflammation-01.pdf"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>png 
  2 
</code></pre></div></div>

<p>Before going further, we will create a directory <code class="highlighter-rouge">results</code> for saving our plots.
It is <a href="http://swcarpentry.github.io/good-enough-practices-in-scientific-computing/">good practice</a> in data analysis projects to save all output to a directory separate from the data and analysis code.
You can create this directory using the shell command <a href="https://swcarpentry.github.io/shell-novice/03-create/">mkdir</a>, or the R function <code class="highlighter-rouge">dir.create()</code></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dir.create</span><span class="p">(</span><span class="s2">"results"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="error highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Warning in dir.create("results"): 'results' already exists
</code></pre></div></div>

<p>Now run <code class="highlighter-rouge">analyze</code> and save the plot in the <code class="highlighter-rouge">results</code> directory,</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">analyze</span><span class="p">(</span><span class="s2">"data/inflammation-01.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"results/inflammation-01.pdf"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>png 
  2 
</code></pre></div></div>

<p>This now works well when we want to process one data file at a time, but how can we specify the output file in <code class="highlighter-rouge">analyze_all</code>?
We need to do two things:</p>

<ol>
  <li>Substitute the filename ending “csv” with “pdf”.</li>
  <li>Save the plot to the <code class="highlighter-rouge">results</code> directory.</li>
</ol>

<p>To change the extension to “pdf”, we will use the function <code class="highlighter-rouge">sub</code>,</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">f</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"inflammation-01.csv"</span><span class="w">
</span><span class="n">sub</span><span class="p">(</span><span class="s2">"csv"</span><span class="p">,</span><span class="w"> </span><span class="s2">"pdf"</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] "inflammation-01.pdf"
</code></pre></div></div>
<p>To add the “results” directory to the filename use the function <code class="highlighter-rouge">file.path</code>,</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">file.path</span><span class="p">(</span><span class="s2">"results"</span><span class="p">,</span><span class="w"> </span><span class="n">sub</span><span class="p">(</span><span class="s2">"csv"</span><span class="p">,</span><span class="w"> </span><span class="s2">"pdf"</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] "results/inflammation-01.pdf"
</code></pre></div></div>

<p>Now let’s update <code class="highlighter-rouge">analyze_all</code>:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">analyze_all</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="c1"># Directory name containing the data</span><span class="w">
  </span><span class="n">data_dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"data"</span><span class="w">
  </span><span class="c1"># Directory name for results</span><span class="w">
  </span><span class="n">results_dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"results"</span><span class="w">
  </span><span class="c1"># Runs the function analyze for each file in the current working directory</span><span class="w">
  </span><span class="c1"># that contains the given pattern.</span><span class="w">
  </span><span class="n">filenames</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">list.files</span><span class="p">(</span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pattern</span><span class="p">)</span><span class="w">
  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">filenames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">pdf_name</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">file.path</span><span class="p">(</span><span class="n">results_dir</span><span class="p">,</span><span class="w"> </span><span class="n">sub</span><span class="p">(</span><span class="s2">"csv"</span><span class="p">,</span><span class="w"> </span><span class="s2">"pdf"</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">))</span><span class="w">
    </span><span class="n">analyze</span><span class="p">(</span><span class="n">file.path</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">),</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdf_name</span><span class="p">)</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Now we can save all of the results with just one line of code:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">analyze_all</span><span class="p">(</span><span class="s2">"inflammation.*csv"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Now if we need to make any changes to our analysis, we can edit the <code class="highlighter-rouge">analyze</code> function and quickly regenerate all the figures with <code class="highlighter-rouge">analyze_all</code>.</p>

<blockquote class="challenge">
  <h2 id="changing-the-behavior-of-the-plot-command">Changing the Behavior of the Plot Command</h2>

  <p>One of your collaborators asks if you can recreate the figures with lines instead of points.
Find the relevant argument to <code class="highlighter-rouge">plot</code> by reading the documentation (<code class="highlighter-rouge">?plot</code>),
update <code class="highlighter-rouge">analyze</code>, and then recreate all the figures with <code class="highlighter-rouge">analyze_all</code>.</p>

  <blockquote class="solution">
    <h2 id="solution-6">Solution</h2>
    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">analyze</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="c1"># Plots the average, min, and max inflammation over time.</span><span class="w">
  </span><span class="c1"># Input:</span><span class="w">
  </span><span class="c1">#    filename: character string of a csv file</span><span class="w">
  </span><span class="c1">#    output: character string of pdf file for saving</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nf">is.null</span><span class="p">(</span><span class="n">output</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">pdf</span><span class="p">(</span><span class="n">output</span><span class="p">)</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="n">dat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
  </span><span class="n">avg_day_inflammation</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w">
  </span><span class="n">plot</span><span class="p">(</span><span class="n">avg_day_inflammation</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">)</span><span class="w">
  </span><span class="n">max_day_inflammation</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="p">)</span><span class="w">
  </span><span class="n">plot</span><span class="p">(</span><span class="n">max_day_inflammation</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">)</span><span class="w">
  </span><span class="n">min_day_inflammation</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="p">)</span><span class="w">
  </span><span class="n">plot</span><span class="p">(</span><span class="n">min_day_inflammation</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">)</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nf">is.null</span><span class="p">(</span><span class="n">output</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">dev.off</span><span class="p">()</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
  </blockquote>
</blockquote>

<p> </p>
<h4 id="using-factors">Using Factors</h4>

<p>Lets load our example data to see the use of factors:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'data/sample.csv'</span><span class="p">,</span><span class="w"> </span><span class="n">stringsAsFactors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<blockquote class="callout">
  <h2 id="default-behavior">Default Behavior</h2>

  <p><code class="highlighter-rouge">stringsAsFactors = TRUE</code> is the default behavior for R.
We could leave this argument out.
It is included here for clarity.</p>
</blockquote>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">str</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'data.frame':	100 obs. of  9 variables:
 $ ID           : Factor w/ 100 levels "Sub001","Sub002",..: 1 2 3 4 5 6 7 8 9 10 ...
 $ Gender       : Factor w/ 4 levels "f","F","m","M": 3 3 3 1 3 4 1 3 3 1 ...
 $ Group        : Factor w/ 3 levels "Control","Treatment1",..: 1 3 3 2 2 3 1 3 3 1 ...
 $ BloodPressure: int  132 139 130 105 125 112 173 108 131 129 ...
 $ Age          : num  16 17.2 19.5 15.7 19.9 14.3 17.7 19.8 19.4 18.8 ...
 $ Aneurisms_q1 : int  114 148 196 199 188 260 135 216 117 188 ...
 $ Aneurisms_q2 : int  140 209 251 140 120 266 98 238 215 144 ...
 $ Aneurisms_q3 : int  202 248 122 233 222 320 154 279 181 192 ...
 $ Aneurisms_q4 : int  237 248 177 220 228 294 245 251 272 185 ...
</code></pre></div></div>

<p>Notice the first 3 columns have been converted to factors. These values were text in the data file so R automatically interpreted them as categorical variables.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">summary</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>       ID     Gender        Group    BloodPressure        Age       
 Sub001 : 1   f:35   Control   :30   Min.   : 62.0   Min.   :12.10  
 Sub002 : 1   F: 4   Treatment1:35   1st Qu.:107.5   1st Qu.:14.78  
 Sub003 : 1   m:46   Treatment2:35   Median :117.5   Median :16.65  
 Sub004 : 1   M:15                   Mean   :118.6   Mean   :16.42  
 Sub005 : 1                          3rd Qu.:133.0   3rd Qu.:18.30  
 Sub006 : 1                          Max.   :173.0   Max.   :20.00  
 (Other):94                                                         
  Aneurisms_q1    Aneurisms_q2    Aneurisms_q3    Aneurisms_q4  
 Min.   : 65.0   Min.   : 80.0   Min.   :105.0   Min.   :116.0  
 1st Qu.:118.0   1st Qu.:131.5   1st Qu.:182.5   1st Qu.:186.8  
 Median :158.0   Median :162.5   Median :217.0   Median :219.0  
 Mean   :158.8   Mean   :168.0   Mean   :219.8   Mean   :217.9  
 3rd Qu.:188.0   3rd Qu.:196.8   3rd Qu.:248.2   3rd Qu.:244.2  
 Max.   :260.0   Max.   :283.0   Max.   :323.0   Max.   :315.0  
                                                                
</code></pre></div></div>

<p>Notice the <code class="highlighter-rouge">summary()</code> function handles factors differently to numbers (and strings), the occurrence counts for each value is often more useful information.</p>

<blockquote class="callout">
  <h2 id="the-summary-function">The <code class="highlighter-rouge">summary()</code> Function</h2>

  <p>The <code class="highlighter-rouge">summary()</code> function is a great way of spotting errors in your data (look at the <em>dat$Gender</em> column).
It’s also a great way for spotting missing data.</p>
</blockquote>

<blockquote class="challenge">
  <h2 id="reordering-factors">Reordering Factors</h2>

  <p>The function <code class="highlighter-rouge">table()</code> tabulates observations and can be used to create bar plots quickly. For instance:</p>

  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">table</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Group</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>

  <div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
   Control Treatment1 Treatment2 
        30         35         35 
</code></pre></div>  </div>

  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">barplot</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Group</span><span class="p">))</span><span class="w">
</span></code></pre></div>  </div>

  <p><img src="../fig/rmd-03-introduction-to-R-data-plotting-reordering-factors-1.png" title="plot of chunk reordering-factors" alt="plot of chunk reordering-factors" width="612" style="display: block; margin: auto;" />
Use the <code class="highlighter-rouge">factor()</code> command to modify the column dat$Group so that the <em>control</em> group is plotted last.</p>
  <blockquote class="solution">
    <h2 id="solution-7">Solution</h2>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dat</span><span class="o">$</span><span class="n">Group</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Group</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Treatment1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Treatment2"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Control"</span><span class="p">))</span><span class="w">
</span><span class="n">barplot</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Group</span><span class="p">))</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-03-introduction-to-R-data-plotting-reordering-factors-2-1.png" title="plot of chunk reordering-factors-2" alt="plot of chunk reordering-factors-2" width="612" style="display: block; margin: auto;" /></p>
  </blockquote>
</blockquote>

<h4 id="removing-levels-from-a-factor">Removing Levels from a Factor</h4>

<p>Some of the Gender values in our dataset have been coded incorrectly.
Let’s remove levels from this factor.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">barplot</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Gender</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-55-1.png" title="plot of chunk unnamed-chunk-55" alt="plot of chunk unnamed-chunk-55" width="612" style="display: block; margin: auto;" /></p>

<p>Values should have been recorded as lowercase ‘m’ and ‘f’. We should correct this.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dat</span><span class="o">$</span><span class="n">Gender</span><span class="p">[</span><span class="n">dat</span><span class="o">$</span><span class="n">Gender</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'M'</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s1">'m'</span><span class="w">
</span></code></pre></div></div>

<blockquote class="challenge">
  <h2 id="updating-factors">Updating Factors</h2>

  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dat</span><span class="o">$</span><span class="n">Gender</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dat</span><span class="o">$</span><span class="n">BloodPressure</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>

  <p><img src="../fig/rmd-03-introduction-to-R-data-plotting-updating-factors-1.png" title="plot of chunk updating-factors" alt="plot of chunk updating-factors" width="612" style="display: block; margin: auto;" /></p>

  <p>Why does this plot show 4 levels?</p>

  <p><em>Hint</em> how many levels does dat$Gender have?</p>
  <blockquote class="solution">
    <h2 id="solution-8">Solution</h2>
    <p><code class="highlighter-rouge">dat$Gender</code> has 4 levels, so the plot shows 4 levels.</p>
  </blockquote>
</blockquote>

<p>We need to tell R that “M” is no longer a valid value for this column.
We use the <code class="highlighter-rouge">droplevels()</code> function to remove extra levels.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dat</span><span class="o">$</span><span class="n">Gender</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">droplevels</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Gender</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dat</span><span class="o">$</span><span class="n">Gender</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dat</span><span class="o">$</span><span class="n">BloodPressure</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-03-introduction-to-R-data-plotting-unnamed-chunk-57-1.png" title="plot of chunk unnamed-chunk-57" alt="plot of chunk unnamed-chunk-57" width="612" style="display: block; margin: auto;" /></p>

<blockquote class="callout">
  <h2 id="adjusting-factor-levels">Adjusting Factor Levels</h2>

  <p>Adjusting the <code class="highlighter-rouge">levels()</code> of a factor provides a useful shortcut for reassigning values in this case.</p>

  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">levels</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Gender</span><span class="p">)[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s1">'f'</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dat</span><span class="o">$</span><span class="n">Gender</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dat</span><span class="o">$</span><span class="n">BloodPressure</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>

  <p><img src="../fig/rmd-03-introduction-to-R-data-plotting-adjusting-levels-1.png" title="plot of chunk adjusting-levels" alt="plot of chunk adjusting-levels" width="612" style="display: block; margin: auto;" /></p>
</blockquote>



<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>Import data from a .csv or .txt file using the <code class="highlighter-rouge">read.table(...)</code>, <code class="highlighter-rouge">read.csv(...)</code>, and <code class="highlighter-rouge">read.delim(...)</code> functions.</p>
</li>
    
    <li><p>Understand some of the key arguments available for importing the data properly, including <code class="highlighter-rouge">header</code>, <code class="highlighter-rouge">stringsAsFactors</code>, <code class="highlighter-rouge">as.is</code>, and <code class="highlighter-rouge">strip.white</code>.</p>
</li>
    
    <li><p>Write data to a new .csv file using the <code class="highlighter-rouge">write.table(...)</code> and <code class="highlighter-rouge">write.csv(...)</code> functions.</p>
</li>
    
    <li><p>Understand some of the key arguments available for exporting the data properly, such as <code class="highlighter-rouge">row.names</code>, <code class="highlighter-rouge">col.names</code>, <code class="highlighter-rouge">quote</code>, and <code class="highlighter-rouge">na.strings</code>.</p>
</li>
    
    <li><p>Use <code class="highlighter-rouge">apply</code> to calculate statistics across the rows or columns of a data frame.</p>
</li>
    
    <li><p>Use <code class="highlighter-rouge">plot</code> to create simple visualizations.</p>
</li>
    
    <li><p>Display simple graphs.</p>
</li>
    
    <li><p>Save a plot in a pdf file using <code class="highlighter-rouge">pdf(...)</code> and stop writing to the pdf file with <code class="highlighter-rouge">dev.off()</code>.</p>
</li>
    
  </ul>
</blockquote>

</article>
















<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../02-introduction-to-R-basics/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../"><span class="glyphicon glyphicon-menu-up" aria-hidden="true"></span><span class="sr-only">lesson home</span></a>
      
    </h3>
  </div>
</div>


      
      






<footer>
  <!--<div class="row">
    <div class="col-md-6 copyright" align="left">
	
    </div>
    <div class="col-md-6 help-links" align="right">
	
	
	<a href="/edit//_episodes_rmd/03-introduction-to-R-data-plotting.Rmd">Edit on GitHub</a>
	
	
	/
	<a href="/blob//CONTRIBUTING.md">Contributing</a>
	/
	<a href="/">Source</a>
	/
	<a href="/blob//CITATION">Cite</a>
	/
	<a href="mailto:sutphin@gmail.com">Contact</a>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12" align="center">
      Using <a href="https://github.com/carpentries/styles/">The Carpentries style</a>
      version <a href="https://github.com/carpentries/styles/releases/tag/v9.5.3">9.5.3</a>.
    </div>
  </div>-->
</footer>

      
    </div>
    
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
